<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="docker基础以及使用">
<title>docker</title>

<link rel='canonical' href='https://gkxgithub.github.io/p/docker/'>

<link rel="stylesheet" href="/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css"><meta property='og:title' content="docker">
<meta property='og:description' content="docker基础以及使用">
<meta property='og:url' content='https://gkxgithub.github.io/p/docker/'>
<meta property='og:site_name' content='yuwen'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-01-15T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-01-15T00:00:00&#43;00:00'/><meta property='og:image' content='https://gkxgithub.github.io/p/docker/01ac71a974dd7ba650a4a36d19e53fa.jpg' />
<meta name="twitter:title" content="docker">
<meta name="twitter:description" content="docker基础以及使用"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://gkxgithub.github.io/p/docker/01ac71a974dd7ba650a4a36d19e53fa.jpg' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu18324190379871123153.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🥰</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">yuwen</a></h1>
            <h2 class="site-description">欢迎来到我的blog</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/637513884'
                        target="_blank"
                        title="bilibili"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.0.0-beta2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M488.6 104.1C505.3 122.2 513 143.8 511.9 169.8V372.2C511.5 398.6 502.7 420.3 485.4 437.3C468.2 454.3 446.3 463.2 419.9 464H92.02C65.57 463.2 43.81 454.2 26.74 436.8C9.682 419.4 .7667 396.5 0 368.2V169.8C.7667 143.8 9.682 122.2 26.74 104.1C43.81 87.75 65.57 78.77 92.02 78H121.4L96.05 52.19C90.3 46.46 87.42 39.19 87.42 30.4C87.42 21.6 90.3 14.34 96.05 8.603C101.8 2.868 109.1 0 117.9 0C126.7 0 134 2.868 139.8 8.603L213.1 78H301.1L375.6 8.603C381.7 2.868 389.2 0 398 0C406.8 0 414.1 2.868 419.9 8.603C425.6 14.34 428.5 21.6 428.5 30.4C428.5 39.19 425.6 46.46 419.9 52.19L394.6 78L423.9 78C450.3 78.77 471.9 87.75 488.6 104.1H488.6zM449.8 173.8C449.4 164.2 446.1 156.4 439.1 150.3C433.9 144.2 425.1 140.9 416.4 140.5H96.05C86.46 140.9 78.6 144.2 72.47 150.3C66.33 156.4 63.07 164.2 62.69 173.8V368.2C62.69 377.4 65.95 385.2 72.47 391.7C78.99 398.2 86.85 401.5 96.05 401.5H416.4C425.6 401.5 433.4 398.2 439.7 391.7C446 385.2 449.4 377.4 449.8 368.2L449.8 173.8zM185.5 216.5C191.8 222.8 195.2 230.6 195.6 239.7V273C195.2 282.2 191.9 289.9 185.8 296.2C179.6 302.5 171.8 305.7 162.2 305.7C152.6 305.7 144.7 302.5 138.6 296.2C132.5 289.9 129.2 282.2 128.8 273V239.7C129.2 230.6 132.6 222.8 138.9 216.5C145.2 210.2 152.1 206.9 162.2 206.5C171.4 206.9 179.2 210.2 185.5 216.5H185.5zM377 216.5C383.3 222.8 386.7 230.6 387.1 239.7V273C386.7 282.2 383.4 289.9 377.3 296.2C371.2 302.5 363.3 305.7 353.7 305.7C344.1 305.7 336.3 302.5 330.1 296.2C323.1 289.9 320.7 282.2 320.4 273V239.7C320.7 230.6 324.1 222.8 330.4 216.5C336.7 210.2 344.5 206.9 353.7 206.5C362.9 206.9 370.7 210.2 377 216.5H377z"/></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/gkxgithub'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E8%BF%9E%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>友情连接</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="https://gkxgithub.github.io/en/" >English</option>
                                
                                    <option value="https://gkxgithub.github.io/" selected>简体中文</option>
                                
                                    <option value="https://gkxgithub.github.io/ar/" >عربي</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#11yum-wget-docker">1.1yum wget docker</a>
      <ol>
        <li><a href="#111yum">1.1.1yum</a></li>
        <li><a href="#112wget">1.1.2wget</a></li>
        <li><a href="#113docker">1.1.3docker</a></li>
        <li><a href="#114关系">1.1.4关系</a></li>
      </ol>
    </li>
    <li><a href="#12部署mysql引入docker">1.2部署MySQL，引入docker</a></li>
    <li><a href="#13命令解读">1.3命令解读</a></li>
  </ol>

  <ol>
    <li><a href="#21常见命令">2.1常见命令</a>
      <ol>
        <li><a href="#211命令介绍">2.1.1.命令介绍</a></li>
        <li><a href="#212演示">2.1.2.演示</a></li>
        <li><a href="#213命令别名">2.1.3.命令别名</a></li>
      </ol>
    </li>
    <li><a href="#22数据卷">2.2.数据卷</a>
      <ol>
        <li><a href="#221什么是数据卷">2.2.1.什么是数据卷</a></li>
        <li><a href="#222数据卷命令">2.2.2.数据卷命令</a></li>
        <li><a href="#223挂载本地目录或文件">2.2.3.挂载本地目录或文件</a></li>
      </ol>
    </li>
    <li><a href="#23镜像">2.3.镜像</a>
      <ol>
        <li><a href="#231镜像结构">2.3.1.镜像结构</a></li>
        <li><a href="#232dockerfile">2.3.2.Dockerfile</a></li>
        <li><a href="#233构建镜像">2.3.3.构建镜像</a></li>
        <li><a href="#234curl命令">2.3.4curl命令</a></li>
      </ol>
    </li>
    <li><a href="#24网络">2.4.网络</a></li>
  </ol>

  <ol>
    <li><a href="#31部署java项目">3.1.部署Java项目</a></li>
    <li><a href="#32部署前端">3.2.部署前端</a></li>
    <li><a href="#33dockercompose">3.3.DockerCompose</a>
      <ol>
        <li><a href="#331基本语法">3.3.1.基本语法</a></li>
        <li><a href="#332基础命令">3.3.2.基础命令</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/docker/">
                <img src="/p/docker/01ac71a974dd7ba650a4a36d19e53fa_hu6390219502494480269.jpg"
                        srcset="/p/docker/01ac71a974dd7ba650a4a36d19e53fa_hu6390219502494480269.jpg 800w, /p/docker/01ac71a974dd7ba650a4a36d19e53fa_hu5853253860288048428.jpg 1600w"
                        width="800" 
                        height="613" 
                        loading="lazy"
                        alt="Featured image of post docker" />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/docker/">docker</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            docker基础以及使用
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2024-01-15</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 42 分钟
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="1快速入门">1.快速入门
</h1><h2 id="11yum-wget-docker">1.1yum wget docker
</h2><h3 id="111yum">1.1.1yum
</h3><p>YUM 它是一个命令行<a class="link" href="https://so.csdn.net/so/search?q=%e8%bd%af%e4%bb%b6%e5%8c%85%e7%ae%a1%e7%90%86%e5%b7%a5%e5%85%b7&amp;spm=1001.2101.3001.7020"  target="_blank" rel="noopener"
    >软件包管理工具</a>，主要用于基于 RPM 的 Linux 发行版（如 CentOS、Red Hat Enterprise Linux、Fedora 等）。YUM 是 “Yellowdog Updater, Modified” 的缩写。它的主要功能包括：</p>
<p>1、自动解决依赖关系：YUM 能够自动解决安装软件包时遇到的依赖问题。</p>
<p>2、简化软件管理：用户可以轻松地安装、更新和删除软件包。</p>
<p>3、支持多个仓库：YUM 支持从多个软件仓库（repositories）下载和安装软件包。</p>
<p>4、易于更新系统：通过简单的命令，用户可以轻松地更新系统中的所有软件包。</p>
<p>常见的YUM命令包括：</p>
<p>yum list | grep &lt;软件包名&gt;：查找软件包。</p>
<p>yum install &lt;软件包名&gt;：安装软件包。</p>
<p>yum remove &lt;软件包名&gt;：删除软件包。</p>
<p>yum update &lt;软件包名&gt;：更新软件包。</p>
<p>yum search &lt;关键词&gt;：搜索软件包。</p>
<p>yum info &lt;软件包名&gt;：显示软件包的详细信息。</p>
<p>使用之前要安装好相关的配置以及yum源。</p>
<h3 id="112wget">1.1.2wget
</h3><ul>
<li>wget命令是一个在Linux和类Unix操作系统中经常使用的网络命令，用途是从指定的URL下载文件。它支持HTTP、HTTPS和FTP协议，支持断点续传，可以下载整个网站。</li>
</ul>
<p>原文链接：https://blog.csdn.net/jks212454/article/details/132345108</p>
<h3 id="113docker">1.1.3docker
</h3><p>Docker ：是一个开源的<a class="link" href="https://so.csdn.net/so/search?q=%e5%ae%b9%e5%99%a8%e5%8c%96&amp;spm=1001.2101.3001.7020"  target="_blank" rel="noopener"
    >容器化</a>平台，它允许开发者将应用程序及其依赖打包进轻量级、可移植的容器中，实现快速、一致和高效的开发、测试和部署 同时提供了环境隔离，使得每个容器都拥有独立的文件系统和网络配置，互不影响；镜像管理功能让应用及其运行环境可以轻松地进行版本控制和分发；</p>
<p>Docker 通过容器化技术，为项目开发、部署和运维提供了一套高效、灵活的解决方案，帮助项目团队解决了环境一致性、依赖管理、开发效率、持续集成/持续部署、微服务架构、资源隔离、弹性伸缩、快速部署、多租户环境、调试能力、资源利用率、跨平台支持和本地开发远程部署等一系列问题；</p>
<p>docker的安装和配置详情</p>
<p>原文链接：https://blog.csdn.net/qq_66851231/article/details/138728913</p>
<h3 id="114关系">1.1.4关系
</h3><p>Docker直接拉取镜像进行使用与yum安装软件在某些方面相似，都提供了简洁的安装方式，但它们在实现机制和应用场景上存在明显差异。</p>
<p>简洁性：</p>
<p>Docker拉取镜像：用户可以通过简单的docker pull [镜像名称]命令从Docker Hub或其他镜像仓库拉取所需的镜像，这些镜像包含了完整的应用程序及其依赖环境，使得部署变得快速且一致。
yum安装软件：yum同样提供了简洁的安装命令yum install [软件包名称]，能够自动处理依赖关系并安装软件包，但它是针对Linux系统中的单个软件包或应用程序进行安装。</p>
<p>实现机制：</p>
<p>Docker：通过容器化技术，将应用程序及其运行环境打包成一个独立的容器，实现了应用程序与宿主机的解耦，确保了应用程序在不同环境中的一致性和可移植性。
yum：基于RPM包管理，通过访问指定的软件仓库，下载并安装软件包及其依赖项，主要用于Linux系统的软件包管理。</p>
<p>应用场景：</p>
<p>Docker：更适用于需要快速部署、扩展和管理复杂应用程序的场景，如微服务架构、持续集成/持续部署（CI/CD）等。
yum：主要用于Linux系统的日常软件包管理，包括系统更新、安全补丁安装以及用户自定义软件包的安装等。</p>
<p>综上所述，虽然Docker拉取镜像进行使用与yum安装软件在简洁性方面有所相似，但它们在实现机制和应用场景上存在显著差异。Docker提供了一种更高级别的应用程序部署和管理方式，而yum则更侧重于Linux系统的软件包管理。</p>
<p>wget和yum是Linux系统中常用的两个工具，它们各自有不同的功能和用途：</p>
<p>wget：</p>
<p>功能：wget是一个命令行下载工具，用于从互联网上下载文件。它支持HTTP、HTTPS和FTP协议，能够下载网页、软件包、文档等各种类型的文件。
特点：wget提供了丰富的选项和参数，如断点续传、限速下载、后台下载等，使得下载过程更加灵活和可控。
用途：wget广泛用于下载文件、镜像网站等场景，是Linux用户不可或缺的工具之一。</p>
<p>yum：</p>
<p>功能：yum是一个基于RPM包管理的软件包管理器，主要用于Red Hat系列的Linux系统中（如CentOS、Fedora等）。它能够自动从指定的软件仓库中下载、安装、更新和删除软件包，并自动处理软件包之间的依赖关系。
特点：yum简化了软件包管理的过程，用户无需手动下载和安装每个依赖的软件包，只需一条命令即可完成安装或更新操作。
用途：yum是Linux系统管理员进行系统维护和软件管理的得力助手，极大地提高了工作效率。</p>
<p>综上所述，wget和yum在Linux系统中各自扮演着重要的角色。wget专注于文件下载，而yum则侧重于软件包的管理。两者相互配合，使得Linux系统的文件和软件管理变得更加高效和便捷。</p>
<h2 id="12部署mysql引入docker">1.2部署MySQL，引入docker
</h2><p>首先，我们利用Docker来安装一个MySQL软件，大家可以对比一下之前传统的安装方式，看看哪个效率更高一些。</p>
<p>如果是利用传统方式部署MySQL，大概的步骤有：</p>
<ul>
<li>搜索并下载MySQL安装包</li>
<li>上传至Linux环境</li>
<li>编译和配置环境</li>
<li>安装</li>
</ul>
<p>而使用Docker安装，仅仅需要一步即可，在命令行输入下面的命令（建议采用CV大法）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">run</span> <span class="n">-d</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="p">-</span><span class="n">-name</span> <span class="n">mysql</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">-p</span> <span class="mf">3306</span><span class="err">:</span><span class="mf">3306</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">-e</span> <span class="n">TZ</span><span class="p">=</span><span class="n">Asia</span><span class="p">/</span><span class="n">Shanghai</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">-e</span> <span class="n">MYSQL_ROOT_PASSWORD</span><span class="p">=</span><span class="mf">123</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">mysql</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>运行效果如图：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135029604.png"
	width="1716"
	height="906"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135029604_hu10095313196619556195.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135029604_hu2667985142482692442.png 1024w"
	loading="lazy"
	
		alt="image-20241015135029604"
	
	
		class="gallery-image" 
		data-flex-grow="189"
		data-flex-basis="454px"
	
></p>
<p>MySQL安装完毕！通过任意客户端工具即可连接到MySQL.</p>
<p>大家可以发现，当我们执行命令后，Docker做的第一件事情，是去自动搜索并下载了MySQL，然后会自动运行MySQL，我们完全不用插手，是不是非常方便。</p>
<p><strong>而且，这种安装方式你完全不用考虑运行的操作系统环境，它不仅仅在CentOS系统是这样，在Ubuntu系统、macOS系统、甚至是装了WSL的Windows下，都可以使用这条命令来安装MySQL。</strong></p>
<p>要知道，<strong>不同操作系统下其安装包、运行环境是都不相同的</strong>！如果是<strong>手动安装，必须手动解决安装包不同、环境不同的、配置不同的问题</strong>！</p>
<p>而使用Docker，这些完全不用考虑。就是因为Docker会自动搜索并下载MySQL。注意：这里下载的不是安装包，而是<strong>镜像。<strong>镜像中不仅包含了MySQL本身，还包含了其运行所需要的环境、配置、系统级函数库。因此它在运行时就有自己独立的环境，就可以跨系统运行，也不需要手动再次配置环境了。这套独立运行的隔离环境我们称为</strong>容器</strong>。</p>
<p>说明：</p>
<ul>
<li>镜像：英文是image</li>
<li>容器：英文是container</li>
</ul>
<blockquote>
<p>因此，Docker安装软件的过程，就是自动搜索下载镜像，然后创建并运行容器的过程。</p>
</blockquote>
<p>Docker会根据命令中的镜像名称自动搜索并下载镜像，那么问题来了，它是去哪里搜索和下载镜像的呢？这些镜像又是谁制作的呢？</p>
<p>Docker官方提供了一个专门管理、存储镜像的网站，并对外开放了镜像上传、下载的权利。Docker官方提供了一些基础镜像，然后各大软件公司又在基础镜像基础上，制作了自家软件的镜像，全部都存放在这个网站。这个网站就成了Docker镜像交流的社区：</p>
<p><a class="link" href="https://hub.docker.com/"  target="_blank" rel="noopener"
    >https://hub.docker.com/</a></p>
<p>基本上我们常用的各种软件都能在这个网站上找到，我们甚至可以自己制作镜像上传上去。</p>
<p>像这种提供存储、管理Docker镜像的服务器，被称为DockerRegistry，可以翻译为镜像仓库。DockerHub网站是官方仓库，阿里云、华为云会提供一些第三方仓库，我们也可以自己搭建私有的镜像仓库。</p>
<p>官方仓库在国外，下载速度较慢，一般我们都会使用第三方仓库提供的镜像加速功能，提高下载速度。而企业内部的机密项目，往往会采用私有镜像仓库。</p>
<p>总之，镜像的来源有两种：</p>
<ul>
<li>基于官方基础镜像自己制作</li>
<li>直接去DockerRegistry下载</li>
</ul>
<p><strong>总结一下</strong>：</p>
<p>Docker本身包含一个后台服务，我们可以利用Docker命令告诉Docker服务，帮助我们快速部署指定的应用。Docker服务部署应用时，首先要去搜索并下载应用对应的镜像，然后根据镜像创建并允许容器，应用就部署完成了。</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135143257.png"
	width="1233"
	height="643"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135143257_hu17100724239324910035.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135143257_hu9286882308656267207.png 1024w"
	loading="lazy"
	
		alt="image-20241015135143257"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="460px"
	
></p>
<h2 id="13命令解读">1.3命令解读
</h2><p>利用Docker快速的安装了MySQL，非常的方便，不过我们执行的命令到底是什么意思呢？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">run</span> <span class="n">-d</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="p">-</span><span class="n">-name</span> <span class="n">mysql</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">-p</span> <span class="mf">3306</span><span class="err">:</span><span class="mf">3306</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">-e</span> <span class="n">TZ</span><span class="p">=</span><span class="n">Asia</span><span class="p">/</span><span class="n">Shanghai</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">-e</span> <span class="n">MYSQL_ROOT_PASSWORD</span><span class="p">=</span><span class="mf">123</span> <span class="p">\</span>
</span></span><span class="line"><span class="cl">  <span class="n">mysql</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>解读：</p>
<ul>
<li><code>docker run -d</code> ：创建并运行一个容器，<code>-d</code>则是让容器以后台进程运行</li>
<li><code>--name mysql </code> : 给容器起个名字叫<code>mysql</code>，你可以叫别的</li>
<li><code>-p 3306:3306</code> : 设置端口映射。
<ul>
<li><strong>容器是隔离环境</strong>，外界不可访问。但是可以<strong>将<strong><strong>宿主机</strong></strong>端口****映射容器内到端口</strong>，当访问宿主机指定端口时，就是在访问容器内的端口了。</li>
<li>容器内端口往往是由容器内的进程决定，例如MySQL进程默认端口是3306，因此容器内端口一定是3306；而宿主机端口则可以任意指定，一般与容器内保持一致。</li>
<li>格式： <code>-p 宿主机端口:容器内端口</code>，示例中就是将宿主机的3306映射到容器内的3306端口</li>
</ul>
</li>
<li><code>-e TZ=Asia/Shanghai</code> : 配置容器内进程运行时的一些参数
<ul>
<li>格式：<code>-e KEY=VALUE</code>，KEY和VALUE都由容器内进程决定</li>
<li>案例中，<code>TZ=Asia/Shanghai</code>是设置时区；<code>MYSQL_ROOT_PASSWORD=123</code>是设置MySQL默认密码</li>
</ul>
</li>
<li><code>mysql</code> : 设置<strong>镜像</strong>名称，Docker会根据这个名字搜索并下载镜像
<ul>
<li>格式：<code>REPOSITORY:TAG</code>，例如<code>mysql:8.0</code>，其中<code>REPOSITORY</code>可以理解为镜像名，<code>TAG</code>是版本号</li>
<li>在未指定<code>TAG</code>的情况下，默认是最新版本，也就是<code>mysql:latest</code></li>
</ul>
</li>
</ul>
</blockquote>
<p>镜像的名称不是随意的，而是要到DockerRegistry中寻找，镜像运行时的配置也不是随意的，要参考镜像的帮助文档，这些在DockerHub网站或者软件的官方网站中都能找到。</p>
<p>如果我们要安装其它软件，也可以到DockerRegistry中寻找对应的镜像名称和版本，阅读相关配置即可。</p>
<h1 id="2docker基础">2.docker基础
</h1><p>接下来，我们一起来学习Docker使用的一些基础知识，为将来部署项目打下基础。具体用法可以参考Docker官方文档：</p>
<p><a class="link" href="https://docs.docker.com/"  target="_blank" rel="noopener"
    >https://docs.docker.com/</a></p>
<h2 id="21常见命令">2.1常见命令
</h2><p>首先我们来学习Docker中的常见命令，可以参考官方文档：</p>
<p><a class="link" href="https://docs.docker.com/engine/reference/commandline/cli/"  target="_blank" rel="noopener"
    >https://docs.docker.com/engine/reference/commandline/cli/</a></p>
<p>当你使用 <code>docker run</code> 命令启动一个容器时，Docker 会首先检查本地是否已经有指定的镜像。如果本地没有这个镜像，Docker 客户端会向 Docker Hub（或者其他配置的仓库）发送请求，自动执行 <code>docker pull</code> 操作来拉取缺失的镜像，然后再使用该镜像启动容器。</p>
<p>这个过程大致如下：</p>
<ol>
<li>
<p><strong>检查本地镜像</strong>：</p>
<ul>
<li>Docker 守护进程会在本地镜像存储中查找指定的镜像和标签（tag）。</li>
</ul>
</li>
<li>
<p><strong>拉取镜像</strong>：</p>
<ul>
<li>如果本地没有找到对应的镜像，Docker 会尝试从配置的镜像仓库（默认是 Docker Hub）拉取镜像。</li>
</ul>
</li>
<li>
<p><strong>启动容器</strong>：</p>
<ul>
<li>一旦镜像被成功拉取到本地，Docker 就会使用这个镜像启动一个新的容器。</li>
</ul>
</li>
</ol>
<p>例如，如果你执行以下命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -d -p 80:80 --name my-nginx nginx
</span></span></code></pre></td></tr></table>
</div>
</div><p>Docker 会首先检查本地是否有 <code>nginx</code> 镜像的最新版本。如果没有，它会从 Docker Hub 上的 <code>nginx</code> 仓库拉取镜像，然后使用这个镜像启动一个名为 <code>my-nginx</code> 的容器，并将容器的 80 端口映射到宿主机的 80 端口。</p>
<p>这个流程是 Docker 的一个重要特性，它确保了容器的快速启动，并且使得镜像的管理和分发变得非常高效。这也意味着用户不需要手动拉取镜像，Docker 会在需要时自动处理。不过，如果你想要确保镜像在运行容器之前已经准备好，或者想要避免在容器启动过程中的网络延迟，你可以先手动执行 <code>docker pull</code> 命令来拉取镜像。</p>
<h3 id="211命令介绍">2.1.1.命令介绍
</h3><p>其中，比较常见的命令有：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>命令</strong></th>
          <th style="text-align: left"><strong>说明</strong></th>
          <th style="text-align: left"><strong>文档地址</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">docker pull</td>
          <td style="text-align: left">拉取镜像</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/pull/"  target="_blank" rel="noopener"
    >docker pull</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker push</td>
          <td style="text-align: left">推送镜像到DockerRegistry</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/push/"  target="_blank" rel="noopener"
    >docker push</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker images</td>
          <td style="text-align: left">查看本地镜像</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/images/"  target="_blank" rel="noopener"
    >docker images</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker rmi</td>
          <td style="text-align: left">删除本地镜像</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/rmi/"  target="_blank" rel="noopener"
    >docker rmi</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker run</td>
          <td style="text-align: left">创建并运行容器（不能重复创建）</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/run/"  target="_blank" rel="noopener"
    >docker run</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker stop</td>
          <td style="text-align: left">停止指定容器</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/stop/"  target="_blank" rel="noopener"
    >docker stop</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker start</td>
          <td style="text-align: left">启动指定容器</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/start/"  target="_blank" rel="noopener"
    >docker start</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker restart</td>
          <td style="text-align: left">重新启动容器</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/restart/"  target="_blank" rel="noopener"
    >docker restart</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker rm</td>
          <td style="text-align: left">删除指定容器</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/rm/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker ps</td>
          <td style="text-align: left">查看容器</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/ps/"  target="_blank" rel="noopener"
    >docker ps</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker logs</td>
          <td style="text-align: left">查看容器运行日志</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/logs/"  target="_blank" rel="noopener"
    >docker logs</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker exec</td>
          <td style="text-align: left">进入容器</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/exec/"  target="_blank" rel="noopener"
    >docker exec</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker save</td>
          <td style="text-align: left">保存镜像到本地压缩文件</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/save/"  target="_blank" rel="noopener"
    >docker save</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker load</td>
          <td style="text-align: left">加载本地压缩文件到镜像</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/load/"  target="_blank" rel="noopener"
    >docker load</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker inspect</td>
          <td style="text-align: left">查看容器详细信息</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/inspect/"  target="_blank" rel="noopener"
    >docker inspect</a></td>
      </tr>
  </tbody>
</table></div>
<p><code>docker exec</code> 命令允许你在运行中的容器内执行命令。这个命令有许多选项，可以帮助你控制如何在容器中执行命令。以下是一些常用的 <code>docker exec</code> 选项及其使用案例：</p>
<ol>
<li>
<p><strong><code>-i</code>, <code>--interactive</code></strong>：</p>
<ul>
<li>保持容器的标准输入（STDIN）打开，即使不附加到容器终端。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -i container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>-t</code>, <code>--tty</code></strong>：</p>
<ul>
<li>分配一个伪终端。通常与 <code>-i</code> 一起使用。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -it container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>-d</code>, <code>--detach</code></strong>：</p>
<ul>
<li>在后台运行命令。默认情况下，<code>docker exec</code> 会附加到容器的标准输出。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -d container_name /my_service.sh
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--detach-keys</code></strong>：</p>
<ul>
<li>指定从容器中分离的键。默认情况下是 <code>ctrl-p,ctrl-q</code>。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --detach-keys <span class="s2">&#34;ctrl-a,ctrl-q&#34;</span> -d container_name /my_service.sh
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--env</code>, <code>-e</code></strong>：</p>
<ul>
<li>设置环境变量。可以设置单个变量或从文件中读取多个变量。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -e <span class="s2">&#34;MY_VAR=value&#34;</span> container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--env-file</code></strong>：</p>
<ul>
<li>从文件中读取环境变量。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --env-file ./env.list container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--workdir</code>, <code>-w</code></strong>：</p>
<ul>
<li>设置容器内命令的工作目录。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -w /path/to/workdir container_name ls -l
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--user</code>, <code>-u</code></strong>：</p>
<ul>
<li>指定执行命令的用户。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -u root container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--privileged</code></strong>：</p>
<ul>
<li>给予容器内的进程访问宿主机所有设备的能力。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --privileged container_name /sbin/service
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--volume</code>, <code>-v</code></strong>：</p>
<ul>
<li>将宿主机的文件系统挂载到容器内。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -v /host/path:/container/path container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--link</code></strong>：</p>
<ul>
<li>将一个运行中的容器链接到另一个容器，以实现容器间的通信。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --link other_container_name:alias container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--name</code></strong>：</p>
<ul>
<li>为执行的命令分配一个名称，使其可以在 <code>docker ps</code> 中显示。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --name my_command container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--replace</code></strong>：</p>
<ul>
<li>如果容器内已经有一个同名的进程在运行，则替换它。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --name my_command --replace container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--signal</code>, <code>-s</code></strong>：</p>
<ul>
<li>向容器内的进程发送一个信号。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -s SIGTERM container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--entrypoint</code></strong>：</p>
<ul>
<li>覆盖容器的入口点。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --entrypoint /custom_entrypoint.sh container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--network</code></strong>：</p>
<ul>
<li>指定容器的网络设置。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --network container_network container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--detach-keys</code></strong>：</p>
<ul>
<li>自定义从容器中分离的键。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> --detach-keys <span class="s2">&#34;ctrl-a,ctrl-b&#34;</span> container_name /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>请注意，<code>docker exec</code> 的某些选项可能不适用于所有场景，具体取决于你的 Docker 版本和配置。在使用这些选项时，建议查阅 Docker 的官方文档，以获取最新的信息和更详细的说明。</p>
<p><code>docker inspect</code> 是一个非常强大的 Docker 命令，它用于获取 Docker 对象（如容器、镜像、网络或卷）的详细信息。这个命令可以输出大量的数据，包括配置、状态、统计信息等。</p>
<p>以下是 <code>docker inspect</code> 的一些常用选项及其使用案例：</p>
<ol>
<li>
<p><strong><code>--format</code>, <code>-f</code></strong>：</p>
<ul>
<li>自定义输出格式，只显示你感兴趣的部分信息。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --format<span class="o">=</span><span class="s1">&#39;{{.Config.Image}}&#39;</span> container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--type</code></strong>：</p>
<ul>
<li>指定要检查的对象类型，如 <code>container</code>、<code>image</code>、<code>network</code> 或 <code>volume</code>。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --type<span class="o">=</span>image my_image
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--all</code>, <code>-a</code></strong>：</p>
<ul>
<li>列出所有容器的详细信息（默认只列出最近的一个容器）。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --all
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--latest</code></strong>：</p>
<ul>
<li>仅列出最后一个创建的容器的详细信息。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --latest
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--size</code>, <code>-s</code></strong>：</p>
<ul>
<li>显示容器的磁盘使用情况。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --size container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--context</code></strong>：</p>
<ul>
<li>指定要检查的上下文环境。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --context my_context container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--mode</code></strong>：</p>
<ul>
<li>指定输出模式，如 <code>json</code> 或 <code>template</code>。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --mode<span class="o">=</span>json container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--timeout</code>, <code>-t</code></strong>：</p>
<ul>
<li>设置命令的超时时间。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --timeout<span class="o">=</span>10s container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--privileged</code></strong>：</p>
<ul>
<li>显示容器是否以特权模式运行。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --privileged container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--restart-policy</code></strong>：</p>
<ul>
<li>显示容器的重启策略。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --restart-policy container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--network</code></strong>：</p>
<ul>
<li>显示容器的网络设置。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --network container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--volume</code></strong>：</p>
<ul>
<li>显示容器的卷挂载信息。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --volume container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--link</code></strong>：</p>
<ul>
<li>显示容器的链接信息。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --link container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--env</code></strong>：</p>
<ul>
<li>显示容器的环境变量。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --env container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--label</code></strong>：</p>
<ul>
<li>显示容器的标签。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --label container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--file</code></strong>：</p>
<ul>
<li>显示容器的 Dockerfile 文件内容。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --file my_image
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--config</code></strong>：</p>
<ul>
<li>显示容器的配置文件内容。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --config container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--events</code></strong>：</p>
<ul>
<li>显示容器的事件日志。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --events container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--stat</code></strong>：</p>
<ul>
<li>显示容器的统计信息。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --stat container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>--top</code></strong>：</p>
<ul>
<li>显示容器的进程列表。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker inspect --top container_name
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>请注意，<code>docker inspect</code> 命令的输出通常是一个 JSON 对象，其中包含了大量信息。使用 <code>--format</code> 选项可以方便地提取特定的信息。此外，<code>docker inspect</code> 命令的选项可能会随着 Docker 版本的更新而变化，因此建议查阅 Docker 的官方文档以获取最新的信息和更详细的说明。</p>
<p>用一副图来表示这些命令的关系：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135224082.png"
	width="1260"
	height="646"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135224082_hu15652958457322597645.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135224082_hu7340930802415014013.png 1024w"
	loading="lazy"
	
		alt="image-20241015135224082"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="468px"
	
></p>
<p>对其进行解读为：</p>
<p>首先，如果想利用docker部署项目，需要先获取项目相关的镜像，安装到本地的镜像如果没有删除可以多次使用。利用已经存在的镜像，用docker run命令，可以生成一个容器，从而运行每一个独立的镜像。</p>
<p>镜像可以由三个途径进行获取：</p>
<p>​	1.通过docker pull从镜像仓库中拉取并下载仓库中已经存在的镜像，利用docker push可以向其中推送。</p>
<p>​	2.通过docker load可以安装本地已经存在的镜像包，就不用从镜像仓库里进行下载了，可以通过docker save对镜像进行打包。</p>
<p>​	3.通过docker build可以利用DOCKERFILE将本地的文件封装成需要使用的镜像。</p>
<p>镜像操作：</p>
<p>​	1.通过docker images可以查看本地已经有的镜像。</p>
<p>​	2.通过docker rmi可以将镜像删除，如果没有删除镜像则可以长期使用。</p>
<p>容器操作：</p>
<p>​	1.利用docker run命令可以创建并且启动容器，相当于已经执行了docker start。</p>
<p>​	2.利用docker start可以启动已经关闭的容器。</p>
<p>​	3.利用docker stop可以关闭已经开启的容器。</p>
<p>​	4.利用docker ps可以查看已经开启的容器。</p>
<p>​	6.利用docker rm可以删除已经存在的容器。</p>
<p>​	7.利用docker logs可以查看容器运行的日志。</p>
<p>​	8.利用docker exec可以对运行的容器进行一些操作和处理。</p>
<p>​	9.利用docker inspect查看容器的详细信息。</p>
<p>补充：</p>
<p>默认情况下，每次重启虚拟机我们都需要手动启动Docker和Docker中的容器。通过命令可以实现开机自启：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="c"># Docker开机自启</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">docker</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Docker容器开机自启</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">update</span> <span class="p">-</span><span class="n">-restart</span><span class="p">=</span><span class="n">always</span> <span class="p">[</span><span class="n">容器名</span><span class="p">/</span><span class="n">容器id</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="212演示">2.1.2.演示
</h3><p>教学环节说明：我们以Nginx为例给大家演示上述命令。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="c"># 第1步，去DockerHub查看nginx镜像仓库及相关信息</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第2步，拉取Nginx镜像</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">pull</span> <span class="n">nginx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第3步，查看镜像</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">images</span>
</span></span><span class="line"><span class="cl"><span class="c"># 结果如下：</span>
</span></span><span class="line"><span class="cl"><span class="n">REPOSITORY</span>   <span class="n">TAG</span>       <span class="n">IMAGE</span> <span class="n">ID</span>       <span class="n">CREATED</span>         <span class="n">SIZE</span>
</span></span><span class="line"><span class="cl"><span class="n">nginx</span>        <span class="n">latest</span>    <span class="n">605c77e624dd</span>   <span class="mf">16</span> <span class="n">months</span> <span class="n">ago</span>   <span class="mf">141</span><span class="p">MB</span>
</span></span><span class="line"><span class="cl"><span class="n">mysql</span>        <span class="n">latest</span>    <span class="n">3218b38490ce</span>   <span class="mf">17</span> <span class="n">months</span> <span class="n">ago</span>   <span class="mf">516</span><span class="p">MB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第4步，创建并允许Nginx容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">run</span> <span class="n">-d</span> <span class="p">-</span><span class="n">-name</span> <span class="n">nginx</span> <span class="n">-p</span> <span class="mf">80</span><span class="err">:</span><span class="mf">80</span> <span class="n">nginx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第5步，查看运行中容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="nb">ps
</span></span></span><span class="line"><span class="cl"><span class="nb"></span><span class="c"># 也可以加格式化方式访问，格式会更加清爽</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="nb">ps </span><span class="p">-</span><span class="n">-format</span> <span class="s2">&#34;table {{.ID}}\t{{.Image}}\t{{.Ports}}\t{{.Status}}\t{{.Names}}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第6步，访问网页，地址：http://虚拟机地址</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第7步，停止容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">stop</span> <span class="n">nginx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第8步，查看所有容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="nb">ps </span><span class="n">-a</span> <span class="p">-</span><span class="n">-format</span> <span class="s2">&#34;table {{.ID}}\t{{.Image}}\t{{.Ports}}\t{{.Status}}\t{{.Names}}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第9步，再次启动nginx容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="nb">start </span><span class="n">nginx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第10步，再次查看容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="nb">ps </span><span class="p">-</span><span class="n">-format</span> <span class="s2">&#34;table {{.ID}}\t{{.Image}}\t{{.Ports}}\t{{.Status}}\t{{.Names}}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第11步，查看容器详细信息</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">inspect</span> <span class="n">nginx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第12步，进入容器,查看容器内目录</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="n">-it</span> <span class="n">nginx</span> <span class="n">bash</span>
</span></span><span class="line"><span class="cl"><span class="c"># 或者，可以进入MySQL</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="n">-it</span> <span class="n">mysql</span> <span class="n">mysql</span> <span class="n">-uroot</span> <span class="n">-p</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 第13步，删除容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="nb">rm </span><span class="n">nginx</span>
</span></span><span class="line"><span class="cl"><span class="c"># 发现无法删除，因为容器运行中，强制删除容器</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="nb">rm </span><span class="o">-f</span> <span class="n">nginx</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="213命令别名">2.1.3.命令别名
</h3><p>给常用Docker命令起别名，方便我们访问：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="c"># 修改/root/.bashrc文件</span>
</span></span><span class="line"><span class="cl"><span class="n">vi</span> <span class="p">/</span><span class="n">root</span><span class="p">/.</span><span class="py">bashrc</span>
</span></span><span class="line"><span class="cl"><span class="n">内容如下</span><span class="err">：</span>
</span></span><span class="line"><span class="cl"><span class="c"># .bashrc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># User specific aliases and functions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="n">rm</span><span class="p">=</span><span class="s1">&#39;rm -i&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="n">cp</span><span class="p">=</span><span class="s1">&#39;cp -i&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="n">mv</span><span class="p">=</span><span class="s1">&#39;mv -i&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="n">dps</span><span class="p">=</span><span class="s1">&#39;docker ps --format &#34;table {{.ID}}\t{{.Image}}\t{{.Ports}}\t{{.Status}}\t{{.Names}}&#34;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="n">dis</span><span class="p">=</span><span class="s1">&#39;docker images&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Source global definitions</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">[</span> <span class="o">-f</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">bashrc</span> <span class="p">];</span> <span class="n">then</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">bashrc</span>
</span></span><span class="line"><span class="cl"><span class="n">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后，执行命令使别名生效，</p>
<p>它所执行的是shell脚本。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="n">source</span> <span class="p">/</span><span class="n">root</span><span class="p">/.</span><span class="py">bashrc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>接下来，试试看新的命令吧。</p>
<h2 id="22数据卷">2.2.数据卷
</h2><p>容器是隔离环境，容器内程序的文件、配置、运行时产生的容器都在容器内部，我们要读写容器内的文件非常不方便。大家思考几个问题：</p>
<ul>
<li>如果要升级MySQL版本，需要销毁旧容器，那么数据岂不是跟着被销毁了？</li>
<li>MySQL、Nginx容器运行后，如果我要修改其中的某些配置该怎么办？</li>
<li>我想要让Nginx代理我的静态资源怎么办？</li>
</ul>
<p>因此，容器提供程序的运行环境，但是<strong>程序运行产生的数据、程序运行依赖的配置都应该与容器解耦</strong>。</p>
<h3 id="221什么是数据卷">2.2.1.什么是数据卷
</h3><p><strong>数据卷（volume）<strong>是一个虚拟目录，是</strong>容器内目录</strong>与<strong>宿主机</strong>目录之间映射的桥梁。</p>
<p>以Nginx为例，我们知道Nginx中有两个关键的目录：</p>
<ul>
<li><code>html</code>：放置一些静态资源</li>
<li><code>conf</code>：放置配置文件</li>
</ul>
<p>如果我们要让Nginx代理我们的静态资源，最好是放到<code>html</code>目录；如果我们要修改Nginx的配置，最好是找到<code>conf</code>下的<code>nginx.conf</code>文件。</p>
<p>但遗憾的是，容器运行的Nginx所有的文件都在容器内部。所以我们必须利用数据卷将两个目录与宿主机目录关联，方便我们操作。如图：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135300226.png"
	width="1074"
	height="661"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135300226_hu12971450016290317018.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135300226_hu4239911730896715285.png 1024w"
	loading="lazy"
	
		alt="image-20241015135300226"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="389px"
	
></p>
<p>在上图中：</p>
<ul>
<li>我们创建了两个数据卷：<code>conf</code>、<code>html</code></li>
<li>Nginx容器内部的<code>conf</code>目录和<code>html</code>目录分别与两个数据卷关联。</li>
<li>而数据卷conf和html分别指向了宿主机的<code>/var/lib/docker/volumes/conf/_data</code>目录和<code>/var/lib/docker/volumes/html/_data</code>目录</li>
</ul>
<p>这样以来，容器内的<code>conf</code>和<code>html</code>目录就 与宿主机的<code>conf</code>和<code>html</code>目录关联起来，我们称为<strong>挂载</strong>。此时，我们操作宿主机的<code>/var/lib/docker/volumes/html/_data</code>就是在操作容器内的<code>/usr/share/nginx/html/_data</code>目录。只要我们将静态资源放入宿主机对应目录，就可以被Nginx代理了。</p>
<p><strong>小提示</strong>：</p>
<p><code>/var/lib/docker/volumes</code>这个目录就是默认的存放所有容器数据卷的目录，其下再根据数据卷名称创建新目录，格式为<code>/数据卷名/_data</code>。</p>
<p><strong>为什么不让容器目录直接指向</strong>宿主机目录呢？</p>
<ul>
<li>因为直接指向宿主机目录就与宿主机强耦合了，如果切换了环境，宿主机目录就可能发生改变了。由于容器一旦创建，目录挂载就无法修改，这样容器就无法正常工作了。</li>
<li>但是容器指向数据卷，一个逻辑名称，而数据卷再指向宿主机目录，就不存在强耦合。如果宿主机目录发生改变，只要改变数据卷与宿主机目录之间的映射关系即可。</li>
</ul>
<p>不过，我们通过由于数据卷目录比较深，不好寻找，通常我们也<strong>允许让容器直接与</strong>宿主机<strong>目录挂载而不使用数据卷</strong>，具体参考2.2.3小节。</p>
<p><strong>那么我想知道既然linux的/home目录为此用户独有的信息储存和管理的区域对吗，它们每个用户无法访问其他人的家目录对吗，那么其它的目录像/var和/lib等就是所有用户共有的吗</strong></p>
<p>在Linux系统中，<code>/home</code> 目录通常用于存放用户的家目录（home directories），每个用户都有一个以用户名命名的子目录。默认情况下，每个用户的家目录只有该用户和 <code>root</code> 用户（超级用户）有权限访问。这是出于隐私和安全性的考虑。以下是一些关于用户目录和系统目录的说明：</p>
<ol>
<li>
<p><strong><code>/home</code> 目录</strong>：</p>
<ul>
<li>存放用户家目录的地方。</li>
<li>每个用户对自己的家目录拥有读、写、执行权限，而其他用户默认没有访问权限。</li>
<li><code>root</code> 用户可以访问所有用户的家目录。</li>
</ul>
</li>
<li>
<p><strong>用户访问其他用户的家目录</strong>：</p>
<ul>
<li>普通用户无法访问其他用户的家目录，除非他们具有相应的权限或使用了 <code>sudo</code> 命令。</li>
<li>系统管理员可以使用 <code>sudo</code> 或切换到目标用户来访问其家目录。</li>
</ul>
</li>
<li>
<p><strong><code>/var</code> 目录</strong>：</p>
<ul>
<li>用于存放经常变动的文件，如日志文件、数据库文件、某些服务的运行时数据等。</li>
<li>这个目录下的内容通常由系统进程和系统管理员管理，普通用户不一定有权限访问或修改这些文件。</li>
</ul>
</li>
<li>
<p><strong><code>/lib</code> 目录</strong>：</p>
<ul>
<li>存放系统库文件，包括动态链接库（如 <code>.so</code> 文件）和静态库文件。</li>
<li>这些文件是系统和应用程序运行所必需的，通常由系统管理员管理。</li>
</ul>
</li>
<li>
<p><strong>系统目录的共享性</strong>：</p>
<ul>
<li>像 <code>/var</code>、<code>/lib</code>、<code>/usr</code>、<code>/opt</code> 等目录是系统级的目录，它们被所有用户共享。</li>
<li>普通用户通常没有权限修改这些目录下的文件，但可以读取某些特定文件或执行某些程序。</li>
</ul>
</li>
<li>
<p><strong>权限管理</strong>：</p>
<ul>
<li>Linux 使用权限管理系统来控制用户对文件和目录的访问。文件和目录的权限可以由 <code>root</code> 用户或具有适当权限的用户更改。</li>
<li>系统管理员可以通过修改文件权限（使用 <code>chmod</code> 命令）或所有权（使用 <code>chown</code> 命令）来控制谁可以访问或修改文件。</li>
</ul>
</li>
<li>
<p><strong>安全性和隐私</strong>：</p>
<ul>
<li>为了保护用户隐私和系统安全，Linux 提供了一套详细的权限管理机制，确保用户只能访问他们被授权访问的资源。</li>
</ul>
</li>
</ol>
<p>总的来说，<code>/home</code> 目录是为每个用户提供的私有存储区域，而 <code>/var</code>、<code>/lib</code> 和其他一些系统目录是所有用户共享的资源。Linux 的权限管理系统确保了用户只能访问他们有权访问的文件和目录，从而保护了系统的安全性和用户的隐私。</p>
<p><strong>那么主目录的/root目录呢</strong></p>
<p>在 Linux 系统中，<code>/root</code> 是系统管理员（通常称为 root 用户）的主目录。这个目录与普通用户的家目录类似，但它属于 root 用户，并且通常具有不同的权限和用途。</p>
<p><strong><code>/root</code> 目录的特点：</strong></p>
<ol>
<li>
<p><strong>所有权</strong>：</p>
<ul>
<li><code>/root</code> 目录属于 root 用户，即系统的超级用户。它的所有者是 root，组通常是 root 或 wheel（取决于具体的 Linux 发行版）。</li>
</ul>
</li>
<li>
<p><strong>权限</strong>：</p>
<ul>
<li><code>/root</code> 目录的权限通常设置为 700（drwx&mdash;&mdash;），这意味着只有 root 用户可以读取、写入和执行目录中的文件。</li>
</ul>
</li>
<li>
<p><strong>内容</strong>：</p>
<ul>
<li><code>/root</code> 目录包含 root 用户的个人文件，如配置文件、文档和其他个人数据。它也可能包含系统管理相关的文件和脚本。</li>
</ul>
</li>
<li>
<p><strong>安全性</strong>：</p>
<ul>
<li>由于 root 用户拥有对整个系统的完全控制权，<code>/root</code> 目录通常受到严格的保护，以防止未授权访问。</li>
</ul>
</li>
<li>
<p><strong>访问控制</strong>：</p>
<ul>
<li>普通用户默认情况下无法访问 <code>/root</code> 目录，除非他们使用 <code>sudo</code> 命令或以 root 用户身份登录。</li>
</ul>
</li>
</ol>
<p><strong>使用 <code>/root</code> 目录的案例：</strong></p>
<ul>
<li><strong>系统管理</strong>：系统管理员可能会在 <code>/root</code> 目录中存放系统管理脚本或敏感配置文件。</li>
<li><strong>备份和恢复</strong>：在系统备份和恢复过程中，<code>/root</code> 目录中的数据可能需要特别处理。</li>
<li><strong>安全审计</strong>：在进行安全审计时，可能需要检查 <code>/root</code> 目录中的文件以确保没有安全隐患。</li>
</ul>
<p><strong>注意事项：</strong></p>
<ul>
<li><strong>谨慎操作</strong>：由于 root 用户的权限非常高，任何在 <code>/root</code> 目录中执行的操作都可能影响整个系统的稳定性和安全性。因此，建议谨慎操作，并确保了解每个命令的影响。</li>
<li><strong>权限管理</strong>：虽然 <code>/root</code> 目录默认对普通用户不可见，但系统管理员仍应定期检查和维护文件权限，以确保系统的安全性。</li>
<li><strong>数据保护</strong>：由于 <code>/root</code> 目录中可能包含敏感数据，建议定期备份这些数据，并采取适当的加密和保护措施。</li>
</ul>
<p>总的来说，<code>/root</code> 目录是 Linux 系统中一个特殊的目录，它为系统管理员提供了一个存放个人文件和系统管理文件的地方。由于其敏感性，建议只有经验丰富的系统管理员才操作这个目录中的文件。</p>
<h3 id="222数据卷命令">2.2.2.数据卷命令
</h3><p>数据卷的相关命令有：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>命令</strong></th>
          <th style="text-align: left"><strong>说明</strong></th>
          <th style="text-align: left"><strong>文档地址</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">docker volume create</td>
          <td style="text-align: left">创建数据卷</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/volume_create/"  target="_blank" rel="noopener"
    >docker volume create</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker volume ls</td>
          <td style="text-align: left">查看所有数据卷</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/volume_ls/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker volume rm</td>
          <td style="text-align: left">删除指定数据卷</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/volume_prune/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker volume inspect</td>
          <td style="text-align: left">查看某个数据卷的详情</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/volume_inspect/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker volume prune</td>
          <td style="text-align: left">清除数据卷</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/volume_prune/"  target="_blank" rel="noopener"
    >docker volume prune</a></td>
      </tr>
  </tbody>
</table></div>
<p><strong>注意：容器与数据卷的挂载要在创建容器时配置，对于创建好的容器，是不能设置数据卷的。而且创建容器的过程中，数据卷会自动创建。</strong></p>
<p>教学<strong>演示环节</strong>：演示一下nginx的html目录挂载</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="c"># 1.首先创建容器并指定数据卷，注意通过 -v 参数来指定数据卷</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">run</span> <span class="n">-d</span> <span class="p">-</span><span class="n">-name</span> <span class="n">nginx</span> <span class="n">-p</span> <span class="mf">80</span><span class="err">:</span><span class="mf">80</span> <span class="n">-v</span> <span class="n">html</span><span class="err">:</span><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">nginx</span><span class="p">/</span><span class="n">html</span> <span class="n">nginx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 2.然后查看数据卷</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">volume</span> <span class="nb">ls
</span></span></span><span class="line"><span class="cl"><span class="nb"></span><span class="c"># 结果</span>
</span></span><span class="line"><span class="cl"><span class="n">DRIVER</span>    <span class="n">VOLUME</span> <span class="n">NAME</span>
</span></span><span class="line"><span class="cl"><span class="n">local</span>     <span class="n">29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f</span>
</span></span><span class="line"><span class="cl"><span class="n">local</span>     <span class="n">html</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 3.查看数据卷详情</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">volume</span> <span class="n">inspect</span> <span class="n">html</span>
</span></span><span class="line"><span class="cl"><span class="c"># 结果</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;CreatedAt&#34;</span><span class="err">:</span> <span class="s2">&#34;2024-05-17T19:57:08+08:00&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Driver&#34;</span><span class="err">:</span> <span class="s2">&#34;local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Labels&#34;</span><span class="err">:</span> <span class="n">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Mountpoint&#34;</span><span class="err">:</span> <span class="s2">&#34;/var/lib/docker/volumes/html/_data&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Name&#34;</span><span class="err">:</span> <span class="s2">&#34;html&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Options&#34;</span><span class="err">:</span> <span class="n">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Scope&#34;</span><span class="err">:</span> <span class="s2">&#34;local&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 4.查看/var/lib/docker/volumes/html/_data目录</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">volumes</span><span class="p">/</span><span class="n">html</span><span class="p">/</span><span class="n">_data</span>
</span></span><span class="line"><span class="cl"><span class="c"># 可以看到与nginx的html目录内容一样，结果如下：</span>
</span></span><span class="line"><span class="cl"><span class="n">总用量</span> <span class="mf">8</span>
</span></span><span class="line"><span class="cl"><span class="n">-rw-r</span><span class="p">-</span><span class="n">-r</span><span class="p">--.</span> <span class="mf">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mf">497</span> <span class="n">12月</span> <span class="mf">28</span> <span class="mf">2021</span> <span class="n">50x</span><span class="p">.</span><span class="py">html</span>
</span></span><span class="line"><span class="cl"><span class="n">-rw-r</span><span class="p">-</span><span class="n">-r</span><span class="p">--.</span> <span class="mf">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mf">615</span> <span class="n">12月</span> <span class="mf">28</span> <span class="mf">2021</span> <span class="n">index</span><span class="p">.</span><span class="py">html</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 5.进入该目录，并随意修改index.html内容</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd </span><span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">volumes</span><span class="p">/</span><span class="n">html</span><span class="p">/</span><span class="n">_data</span>
</span></span><span class="line"><span class="cl"><span class="n">vi</span> <span class="n">index</span><span class="p">.</span><span class="py">html</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 6.打开页面，查看效果</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># 7.进入容器内部，查看/usr/share/nginx/html目录内的文件是否变化</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="n">-it</span> <span class="n">nginx</span> <span class="n">bash</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>具体的执行过程</strong></p>
<p>当你执行 <code>docker run</code> 命令并使用 <code>-v</code> 选项来指定一个数据卷时，Docker 会进行一系列操作来设置和挂载数据卷。下面是你提供的命令的具体过程：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	--name nginx <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	-p 80:80 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	-v html:/usr/share/nginx/html <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	nginx
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>
<p><strong>解析命令</strong>：</p>
<ul>
<li>Docker 客户端解析命令行参数，识别出要创建一个名为 <code>nginx</code> 的新容器，将宿主机的 80 端口映射到容器的 80 端口，并挂载一个名为 <code>html</code> 的数据卷到容器的 <code>/usr/share/nginx/html</code> 目录。</li>
</ul>
</li>
<li>
<p><strong>检查数据卷</strong>：</p>
<ul>
<li>Docker 检查本地是否存在名为 <code>html</code> 的数据卷。如果不存在，Docker 会在 <code>/var/lib/docker/volumes</code> 目录下创建一个新的数据卷。</li>
</ul>
</li>
<li>
<p><strong>创建数据卷</strong>：</p>
<ul>
<li>如果数据卷不存在，Docker 会在 <code>/var/lib/docker/volumes/html/_data</code> 下创建必要的目录结构。<code>_data</code> 是 Docker 用来标识数据卷内容的默认后缀。</li>
</ul>
</li>
<li>
<p><strong>设置权限</strong>：</p>
<ul>
<li>Docker 设置数据卷的权限，确保容器内的用户（在这个例子中是 Nginx）有权访问和修改数据卷中的文件。</li>
</ul>
</li>
<li>
<p><strong>启动容器</strong>：</p>
<ul>
<li>Docker 拉取（如果本地没有）并启动 Nginx 镜像，创建一个新的容器实例。</li>
</ul>
</li>
<li>
<p><strong>挂载数据卷</strong>：</p>
<ul>
<li>Docker 将名为 <code>html</code> 的数据卷挂载到容器的 <code>/usr/share/nginx/html</code> 目录。这意味着容器内的 <code>/usr/share/nginx/html</code> 目录实际上是指向宿主机上的 <code>/var/lib/docker/volumes/html/_data</code> 目录。</li>
</ul>
</li>
<li>
<p><strong>容器操作</strong>：</p>
<ul>
<li>在容器内部，任何对 <code>/usr/share/nginx/html</code> 目录的读写操作都会反映在宿主机的 <code>/var/lib/docker/volumes/html/_data</code> 目录。</li>
</ul>
</li>
<li>
<p><strong>数据持久性</strong>：</p>
<ul>
<li>由于数据卷独立于容器的生命周期，即使容器被删除，数据卷中的数据也不会丢失。</li>
</ul>
</li>
</ol>
<p>这个过程展示了 Docker 数据卷的灵活性和便利性，它允许你轻松地在容器之间共享数据，同时保持数据的持久性和独立性。通过使用数据卷，你可以在不同的容器实例之间迁移数据，或者在容器被删除后保留数据。</p>
<p>教学<strong>演示环节</strong>：演示一下MySQL的匿名数据卷</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="c"># 1.查看MySQL容器详细信息</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">inspect</span> <span class="n">mysql</span>
</span></span><span class="line"><span class="cl"><span class="c"># 关注其中.Config.Volumes部分和.Mounts部分</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们关注两部分内容，第一是<code>.Config.Volumes</code>部分：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSON" data-lang="JSON"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;Config&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ... 略
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;Volumes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;/var/lib/mysql&#34;</span><span class="p">:</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ... 略
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以发现这个容器声明了一个本地目录，需要挂载数据卷，但是<strong>数据卷未定义</strong>。这就是匿名卷。</p>
<p>然后，我们再看结果中的<code>.Mounts</code>部分：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSON" data-lang="JSON"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;Mounts&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;Type&#34;</span><span class="p">:</span> <span class="s2">&#34;volume&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;Name&#34;</span><span class="p">:</span> <span class="s2">&#34;29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;Source&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/lib/docker/volumes/29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f/_data&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;Destination&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/lib/mysql&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;Driver&#34;</span><span class="p">:</span> <span class="s2">&#34;local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以发现，其中有几个关键属性：</p>
<ul>
<li>Name：数据卷名称。由于定义容器未设置容器名，这里的就是匿名卷自动生成的名字，一串hash值。</li>
<li>Source：宿主机目录</li>
<li>Destination : 容器内的目录</li>
</ul>
<p>上述配置是将容器内的<code>/var/lib/mysql</code>这个目录，与数据卷<code>29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f</code>挂载。于是在宿主机中就有了<code>/var/lib/docker/volumes/29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f/_data</code>这个目录。这就是匿名数据卷对应的目录，其使用方式与普通数据卷没有差别。</p>
<p>接下来，可以查看该目录下的MySQL的data文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">ls -l /var/lib/docker/volumes/29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f/_data
</span></span></code></pre></td></tr></table>
</div>
</div><p>注意：每一个不同的镜像，将来创建容器后内部有哪些目录可以挂载，可以参考DockerHub对应的页面</p>
<h3 id="223挂载本地目录或文件">2.2.3.挂载本地目录或文件
</h3><p>可以发现，数据卷的目录结构较深，如果我们去操作数据卷目录会不太方便。在很多情况下，我们会直接将容器目录与宿主机指定目录挂载。挂载语法与数据卷类似：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 挂载本地目录</span>
</span></span><span class="line"><span class="cl">-v 本地目录:容器内目录
</span></span><span class="line"><span class="cl"><span class="c1"># 挂载本地文件</span>
</span></span><span class="line"><span class="cl">-v 本地文件:容器内文件
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>注意</strong>：本地目录或文件必须以 <code>/</code> 或 <code>./</code>开头，如果直接以名字开头，会被识别为数据卷名而非本地目录名。</p>
<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">-v mysql:/var/lib/mysql <span class="c1"># 会被识别为一个数据卷叫mysql，运行时会自动创建这个数据卷</span>
</span></span><span class="line"><span class="cl">-v ./mysql:/var/lib/mysql <span class="c1"># 会被识别为当前目录下的mysql目录，运行时如果不存在会创建目录</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>教学演示</strong>，删除并重新创建mysql容器，并完成本地目录挂载：</p>
<ul>
<li>挂载<code>/root/mysql/data</code>到容器内的<code>/var/lib/mysql</code>目录</li>
<li>挂载<code>/root/mysql/init</code>到容器内的<code>/docker-entrypoint-initdb.d</code>目录（初始化的SQL脚本目录）</li>
<li>挂载<code>/root/mysql/conf</code>到容器内的<code>/etc/mysql/conf.d</code>目录（这个是MySQL配置文件目录）</li>
</ul>
<p>Docker 中，确定要挂载到容器的具体目录通常取决于你使用的 Docker 镜像的设计和需求。不同的镜像可能会有不同的默认目录用于存放数据、配置文件和初始化脚本。以下是一些常见的方法来确定这些目录：</p>
<ol>
<li>
<p><strong>查看 Docker 镜像文档</strong>：</p>
<ul>
<li>许多官方和社区维护的 Docker 镜像在其文档中会详细说明数据卷应该挂载到哪些目录。例如，MySQL 官方镜像的文档会说明数据卷应该挂载到 <code>/var/lib/mysql</code>。</li>
</ul>
</li>
<li>
<p><strong>检查 Docker 镜像的 Dockerfile</strong>：</p>
<ul>
<li>Dockerfile 是构建 Docker 镜像的脚本。通过查看 Dockerfile，你可以了解镜像中的目录结构和配置。例如，MySQL 镜像的 Dockerfile 可能会有指令将数据和配置文件放在特定的目录。</li>
</ul>
</li>
<li>
<p><strong>查看 Docker 容器的层</strong>：</p>
<ul>
<li>你可以使用 <code>docker history</code> 命令来查看 Docker 容器的层，这有助于你了解容器内部的文件系统结构。</li>
</ul>
</li>
<li>
<p><strong>运行交互式容器</strong>：</p>
<ul>
<li>你可以运行一个交互式的容器实例，然后使用 <code>docker exec</code> 命令进入容器内部，手动检查目录结构和配置文件的位置。</li>
</ul>
</li>
<li>
<p><strong>查看 Docker 镜像的配置文件</strong>：</p>
<ul>
<li>对于一些镜像，配置文件可能已经包含在镜像中。你可以通过查看这些配置文件来了解它们期望的数据卷挂载点。</li>
</ul>
</li>
<li>
<p><strong>使用 Docker 镜像的标签</strong>：</p>
<ul>
<li>一些 Docker 镜像提供了不同的标签（tags），每个标签可能对应不同的配置。查看这些标签的文档可以帮助你了解正确的挂载点。</li>
</ul>
</li>
<li>
<p><strong>社区和论坛</strong>：</p>
<ul>
<li>如果你无法通过上述方法找到信息，你可以在社区论坛、GitHub 仓库或 Stack Overflow 等平台上搜索或提问。</li>
</ul>
</li>
</ol>
<p>对于 MySQL 容器，以下是挂载数据卷的一般步骤：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --name mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /root/mysql/data:/var/lib/mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /root/mysql/init:/docker-entrypoint-initdb.d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /root/mysql/conf:/etc/mysql/conf.d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  mysql:tag
</span></span></code></pre></td></tr></table>
</div>
</div><p>在这个命令中：</p>
<ul>
<li><code>/var/lib/mysql</code> 是 MySQL 容器内用于存储数据库文件的默认目录。</li>
<li><code>/docker-entrypoint-initdb.d</code> 是 MySQL 容器内用于初始化数据库时执行 SQL 脚本的默认目录。</li>
<li><code>/etc/mysql/conf.d</code> 是 MySQL 容器内用于存放配置文件的默认目录。</li>
</ul>
<p>请注意，<code>tag</code> 应该被替换为具体的 MySQL 镜像标签，例如 <code>5.7</code> 或 <code>latest</code>。确保你使用的镜像标签与你的需求相匹配，并且挂载的宿主机目录对你的应用程序是可访问的。</p>
<p>在课前资料中已经准备好了mysql的<code>init</code>目录和<code>conf</code>目录：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135344148.png"
	width="967"
	height="196"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135344148_hu17887681439016469704.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135344148_hu4989354079291925790.png 1024w"
	loading="lazy"
	
		alt="image-20241015135344148"
	
	
		class="gallery-image" 
		data-flex-grow="493"
		data-flex-basis="1184px"
	
></p>
<p>以及对应的初始化SQL脚本和配置文件：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135356624.png"
	width="852"
	height="151"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135356624_hu11177970466526257150.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135356624_hu9075151546497426435.png 1024w"
	loading="lazy"
	
		alt="image-20241015135356624"
	
	
		class="gallery-image" 
		data-flex-grow="564"
		data-flex-basis="1354px"
	
></p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135412682.png"
	width="876"
	height="141"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135412682_hu1858204500234665238.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135412682_hu11610916951193699798.png 1024w"
	loading="lazy"
	
		alt="image-20241015135412682"
	
	
		class="gallery-image" 
		data-flex-grow="621"
		data-flex-basis="1491px"
	
></p>
<p>其中，hm.cnf主要是配置了MySQL的默认编码，改为utf8mb4；而hmall.sql则是后面我们要用到的黑马商城项目的初始化SQL脚本。</p>
<p>我们直接将整个mysql目录上传至虚拟机的<code>/root</code>目录下：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135429177.png"
	width="1266"
	height="308"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135429177_hu11585982413590997714.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135429177_hu7353924873667502609.png 1024w"
	loading="lazy"
	
		alt="image-20241015135429177"
	
	
		class="gallery-image" 
		data-flex-grow="411"
		data-flex-basis="986px"
	
></p>
<p>接下来，我们演示本地目录挂载：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 1.删除原来的MySQL容器</span>
</span></span><span class="line"><span class="cl">docker rm -f mysql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2.进入root目录</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ~
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3.创建并运行新mysql容器，挂载本地目录</span>
</span></span><span class="line"><span class="cl">docker run -d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --name mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p 3306:3306 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -e <span class="nv">TZ</span><span class="o">=</span>Asia/Shanghai <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -e <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span><span class="m">123</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v ./mysql/data:/var/lib/mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v ./mysql/conf:/etc/mysql/conf.d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v ./mysql/init:/docker-entrypoint-initdb.d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  mysql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4.查看root目录，可以发现~/mysql/data目录已经自动创建好了</span>
</span></span><span class="line"><span class="cl">ls -l mysql
</span></span><span class="line"><span class="cl"><span class="c1"># 结果：</span>
</span></span><span class="line"><span class="cl">总用量 <span class="m">4</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root    root   <span class="m">20</span> 5月  <span class="m">19</span> 15:11 conf
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">7</span> polkitd root <span class="m">4096</span> 5月  <span class="m">19</span> 15:11 data
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root    root   <span class="m">23</span> 5月  <span class="m">19</span> 15:11 init
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 查看data目录，会发现里面有大量数据库数据，说明数据库完成了初始化</span>
</span></span><span class="line"><span class="cl">ls -l data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 5.查看MySQL容器内数据</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 5.1.进入MySQL</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it mysql mysql -uroot -p123
</span></span><span class="line"><span class="cl"><span class="c1"># 5.2.查看编码表</span>
</span></span><span class="line"><span class="cl">show variables like <span class="s2">&#34;%char%&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 5.3.结果，发现编码是utf8mb4没有问题</span>
</span></span><span class="line"><span class="cl">+--------------------------+--------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Variable_name            <span class="p">|</span> Value                          <span class="p">|</span>
</span></span><span class="line"><span class="cl">+--------------------------+--------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_set_client     <span class="p">|</span> utf8mb4                        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_set_connection <span class="p">|</span> utf8mb4                        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_set_database   <span class="p">|</span> utf8mb4                        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_set_filesystem <span class="p">|</span> binary                         <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_set_results    <span class="p">|</span> utf8mb4                        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_set_server     <span class="p">|</span> utf8mb4                        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_set_system     <span class="p">|</span> utf8mb3                        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> character_sets_dir       <span class="p">|</span> /usr/share/mysql-8.0/charsets/ <span class="p">|</span>
</span></span><span class="line"><span class="cl">+--------------------------+--------------------------------+
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 6.查看数据</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 6.1.查看数据库</span>
</span></span><span class="line"><span class="cl">show databases<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 结果，hmall是黑马商城数据库</span>
</span></span><span class="line"><span class="cl">+--------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Database           <span class="p">|</span>
</span></span><span class="line"><span class="cl">+--------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> hmall              <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> information_schema <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> mysql              <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> performance_schema <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> sys                <span class="p">|</span>
</span></span><span class="line"><span class="cl">+--------------------+
</span></span><span class="line"><span class="cl"><span class="m">5</span> rows in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 6.2.切换到hmall数据库</span>
</span></span><span class="line"><span class="cl">use hmall<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 6.3.查看表</span>
</span></span><span class="line"><span class="cl">show tables<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 结果：</span>
</span></span><span class="line"><span class="cl">+-----------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Tables_in_hmall <span class="p">|</span>
</span></span><span class="line"><span class="cl">+-----------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> address         <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> cart            <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> item            <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> order           <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> order_detail    <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> order_logistics <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> pay_order       <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> user            <span class="p">|</span>
</span></span><span class="line"><span class="cl">+-----------------+
</span></span><span class="line"><span class="cl"><span class="c1"># 6.4.查看address表数据</span>
</span></span><span class="line"><span class="cl">+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> id <span class="p">|</span> user_id <span class="p">|</span> province <span class="p">|</span> city   <span class="p">|</span> town     <span class="p">|</span> mobile      <span class="p">|</span> street        <span class="p">|</span> contact   <span class="p">|</span> is_default <span class="p">|</span> notes <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">59</span> <span class="p">|</span>       <span class="m">1</span> <span class="p">|</span> 北京     <span class="p">|</span> 北京   <span class="p">|</span> 朝阳区    <span class="p">|</span> <span class="m">13900112222</span> <span class="p">|</span> 金燕龙办公楼   <span class="p">|</span> 李佳诚    <span class="p">|</span> <span class="m">0</span>          <span class="p">|</span> NULL  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">60</span> <span class="p">|</span>       <span class="m">1</span> <span class="p">|</span> 北京     <span class="p">|</span> 北京   <span class="p">|</span> 朝阳区    <span class="p">|</span> <span class="m">13700221122</span> <span class="p">|</span> 修正大厦       <span class="p">|</span> 李佳红    <span class="p">|</span> <span class="m">0</span>          <span class="p">|</span> NULL  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">61</span> <span class="p">|</span>       <span class="m">1</span> <span class="p">|</span> 上海     <span class="p">|</span> 上海   <span class="p">|</span> 浦东新区  <span class="p">|</span> <span class="m">13301212233</span> <span class="p">|</span> 航头镇航头路   <span class="p">|</span> 李佳星    <span class="p">|</span> <span class="m">1</span>          <span class="p">|</span> NULL  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">63</span> <span class="p">|</span>       <span class="m">1</span> <span class="p">|</span> 广东     <span class="p">|</span> 佛山   <span class="p">|</span> 永春      <span class="p">|</span> <span class="m">13301212233</span> <span class="p">|</span> 永春武馆       <span class="p">|</span> 李晓龙    <span class="p">|</span> <span class="m">0</span>          <span class="p">|</span> NULL  <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+
</span></span><span class="line"><span class="cl"><span class="m">4</span> rows in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="23镜像">2.3.镜像
</h2><p>前面我们一直在使用别人准备好的镜像，那如果我要部署一个Java项目，把它打包为一个镜像该怎么做呢？</p>
<h3 id="231镜像结构">2.3.1.镜像结构
</h3><p>要想自己构建镜像，必须先了解镜像的结构。</p>
<p>之前我们说过，镜像之所以能让我们快速跨操作系统部署应用而忽略其运行环境、配置，就是因为镜像中包含了程序运行需要的系统函数库、环境、配置、依赖。</p>
<p>因此，自定义镜像本质就是依次准备好程序运行的基础环境、依赖、应用本身、运行配置等文件，并且打包而成。</p>
<p>举个例子，我们要从0部署一个Java应用，大概流程是这样：</p>
<ul>
<li>准备一个linux服务（CentOS或者Ubuntu均可）</li>
<li>安装并配置JDK</li>
<li>上传Jar包</li>
<li>运行jar包</li>
</ul>
<p>那因此，我们打包镜像也是分成这么几步：</p>
<ul>
<li>准备Linux运行环境（java项目并不需要完整的操作系统，仅仅是基础运行环境即可）</li>
<li>安装并配置JDK</li>
<li>拷贝jar包</li>
<li>配置启动脚本</li>
</ul>
<p>上述步骤中的每一次操作其实都是在生产一些文件（系统运行环境、函数库、配置最终都是磁盘文件），所以<strong>镜像就是一堆文件的集合</strong>。</p>
<p>但需要注意的是，镜像文件不是随意堆放的，而是按照操作的步骤分层叠加而成，每一层形成的文件都会单独打包并标记一个唯一id，称为<strong>Layer</strong>（<strong>层</strong>）。这样，如果我们构建时用到的某些层其他人已经制作过，就可以直接拷贝使用这些层，而不用重复制作。</p>
<p>例如，第一步中需要的Linux运行环境，通用性就很强，所以Docker官方就制作了这样的只包含Linux运行环境的镜像。我们在制作java镜像时，就无需重复制作，直接使用Docker官方提供的CentOS或Ubuntu镜像作为基础镜像。然后再搭建其它层即可，这样逐层搭建，最终整个Java项目的镜像结构如图所示：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135506114.png"
	width="1999"
	height="1068"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135506114_hu10222904822590055049.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135506114_hu6854308606057090360.png 1024w"
	loading="lazy"
	
		alt="image-20241015135506114"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="449px"
	
></p>
<h3 id="232dockerfile">2.3.2.Dockerfile
</h3><p>由于制作镜像的过程中，需要逐层处理和打包，比较复杂，所以Docker就提供了自动打包镜像的功能。我们只需要将打包的过程，每一层要做的事情用固定的语法写下来，交给Docker去执行即可。</p>
<p>而这种记录镜像结构的文件就称为<strong>Dockerfile</strong>，其对应的语法可以参考官方文档：</p>
<p><a class="link" href="https://docs.docker.com/engine/reference/builder/"  target="_blank" rel="noopener"
    >https://docs.docker.com/engine/reference/builder/</a></p>
<p>其中的语法比较多，比较常用的有：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>指令</strong></th>
          <th style="text-align: left"><strong>说明</strong></th>
          <th style="text-align: left"><strong>示例</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>FROM</strong></td>
          <td style="text-align: left">指定基础镜像</td>
          <td style="text-align: left"><code>FROM centos:6</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>ENV</strong></td>
          <td style="text-align: left">设置环境变量，可在后面指令使用</td>
          <td style="text-align: left"><code>ENV key value</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>COPY</strong></td>
          <td style="text-align: left">拷贝本地文件到镜像的指定目录</td>
          <td style="text-align: left"><code>COPY ./xx.jar /tmp/app.jar</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>RUN</strong></td>
          <td style="text-align: left">执行Linux的shell命令，一般是安装过程的命令</td>
          <td style="text-align: left"><code>RUN yum install gcc</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>EXPOSE</strong></td>
          <td style="text-align: left">指定容器运行时监听的端口，是给镜像使用者看的</td>
          <td style="text-align: left">EXPOSE 8080</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>ENTRYPOINT</strong></td>
          <td style="text-align: left">镜像中应用的启动命令，容器运行时调用</td>
          <td style="text-align: left">ENTRYPOINT java -jar xx.jar</td>
      </tr>
  </tbody>
</table></div>
<p>例如，要基于Ubuntu镜像来构建一个Java应用，其Dockerfile内容如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="line"><span class="cl"><span class="c"># 指定基础镜像</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s"> ubuntu:16.04</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 配置环境变量，JDK的安装目录、容器内时区</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">JAVA_DIR</span><span class="o">=</span>/usr/local<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">TZ</span><span class="o">=</span>Asia/Shanghai<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 拷贝jdk和java项目的包</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./jdk8.tar.gz <span class="nv">$JAVA_DIR</span>/<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./docker-demo.jar /tmp/app.jar<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 设定时区</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> ln -snf /usr/share/zoneinfo/<span class="nv">$TZ</span> /etc/localtime <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="nv">$TZ</span> &gt; /etc/timezone<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 安装JDK</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">cd</span> <span class="nv">$JAVA_DIR</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> <span class="o">&amp;&amp;</span> tar -xf ./jdk8.tar.gz <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> <span class="o">&amp;&amp;</span> mv ./jdk1.8.0_144 ./java8<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 配置环境变量</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">JAVA_HOME</span><span class="o">=</span><span class="nv">$JAVA_DIR</span>/java8<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$JAVA_HOME</span>/bin<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 指定项目监听的端口</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 8080</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 入口，java项目的启动命令</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;java&#34;</span><span class="p">,</span> <span class="s2">&#34;-jar&#34;</span><span class="p">,</span> <span class="s2">&#34;/app.jar&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>同学们思考一下：以后我们会有很多很多java项目需要打包为镜像，他们都需要Linux系统环境、JDK环境这两层，只有上面的3层不同（因为jar包不同）。如果每次制作java镜像都重复制作前两层镜像，是不是很麻烦。</p>
<p>所以，就有人提供了基础的系统加JDK环境，我们在此基础上制作java镜像，就可以省去JDK的配置了：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="line"><span class="cl"><span class="c"># 基础镜像</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s"> openjdk:11.0-jre-buster</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 设定时区</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">TZ</span><span class="o">=</span>Asia/Shanghai<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> ln -snf /usr/share/zoneinfo/<span class="nv">$TZ</span> /etc/localtime <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="nv">$TZ</span> &gt; /etc/timezone<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 拷贝jar包</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> docker-demo.jar /app.jar<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 入口</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;java&#34;</span><span class="p">,</span> <span class="s2">&#34;-jar&#34;</span><span class="p">,</span> <span class="s2">&#34;/app.jar&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>是不是简单多了。</p>
<p>此段 Dockerfile 定义了一个基于 <code>openjdk:11.0-jre-buster</code> 镜像的 Docker 容器，用于运行一个 Java 应用程序。这个 Dockerfile 中的指令与底层操作系统（如 CentOS 或 Ubuntu）无关，因为它描述的是一个隔离的 Docker 环境，其中包含了运行 Java 应用程序所需的所有依赖。</p>
<p>这里是 Dockerfile 中各行的含义：</p>
<ol>
<li>
<p><code>FROM openjdk:11.0-jre-buster</code>：</p>
<ul>
<li>指定基础镜像，这里使用的是包含 OpenJDK 11 运行时环境的官方 Java 镜像，标签为 <code>buster</code>，基于 Debian GNU/Linux 系统。</li>
</ul>
</li>
<li>
<p><code>ENV TZ=Asia/Shanghai</code>：</p>
<ul>
<li>设置环境变量 <code>TZ</code> 为上海时区。</li>
</ul>
</li>
<li>
<p><code>RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone</code>：</p>
<ul>
<li>创建一个符号链接，将 <code>/usr/share/zoneinfo/$TZ</code> 指向 <code>/etc/localtime</code>，设置容器的时区。</li>
<li>将时区信息写入 <code>/etc/timezone</code> 文件。</li>
</ul>
</li>
<li>
<p><code>COPY docker-demo.jar /app.jar</code>：</p>
<ul>
<li>将构建的 Java 应用程序 JAR 文件 <code>docker-demo.jar</code> 复制到容器中的 <code>/app.jar</code>。</li>
</ul>
</li>
<li>
<p><code>ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]</code>：</p>
<ul>
<li>设置容器启动时执行的命令，即运行 <code>/app.jar</code> 这个 Java 应用程序。</li>
</ul>
</li>
</ol>
<p>这个 Dockerfile 适用于任何支持 Docker 的系统，包括 CentOS 和 Ubuntu。它不依赖于宿主机的操作系统，因为 Docker 容器在设计上就是为了提供一致的环境，无论宿主机是什么操作系统。</p>
<p>要在 CentOS 或 Ubuntu 上使用这个 Dockerfile，你需要确保这些系统上安装了 Docker。然后，你可以在这些系统上执行以下步骤：</p>
<ol>
<li>将 Dockerfile 保存到你的项目目录中。</li>
<li>在该目录中运行 <code>docker build</code> 命令来构建镜像。</li>
<li>使用 <code>docker run</code> 命令来启动基于该镜像的容器。</li>
</ol>
<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -t my-java-app .
</span></span><span class="line"><span class="cl">docker run -d -p 8080:8080 my-java-app
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里 <code>-t my-java-app</code> 为新创建的镜像指定了一个标签，而 <code>-p 8080:8080</code> 将容器的 8080 端口映射到宿主机的 8080 端口。</p>
<h3 id="233构建镜像">2.3.3.构建镜像
</h3><p>当Dockerfile文件写好以后，就可以利用命令来构建镜像了。</p>
<p>在课前资料中，我们准备好了一个demo项目及对应的Dockerfile：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135527832.png"
	width="865"
	height="183"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135527832_hu14687103377185859510.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135527832_hu5199879668816956545.png 1024w"
	loading="lazy"
	
		alt="image-20241015135527832"
	
	
		class="gallery-image" 
		data-flex-grow="472"
		data-flex-basis="1134px"
	
></p>
<p>首先，我们将课前资料提供的<code>docker-demo.jar</code>包以及<code>Dockerfile</code>拷贝到虚拟机的<code>/root/demo</code>目录：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135548265.png"
	width="962"
	height="204"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135548265_hu2636331887607754252.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135548265_hu9127222820541969957.png 1024w"
	loading="lazy"
	
		alt="image-20241015135548265"
	
	
		class="gallery-image" 
		data-flex-grow="471"
		data-flex-basis="1131px"
	
></p>
<p>然后，执行命令，构建镜像：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 进入镜像目录</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /root/demo
</span></span><span class="line"><span class="cl"><span class="c1"># 开始构建</span>
</span></span><span class="line"><span class="cl">docker build -t docker-demo:1.0 .
</span></span></code></pre></td></tr></table>
</div>
</div><p>命令说明：</p>
<ul>
<li>
<p><code>docker build </code>: 就是构建一个docker镜像</p>
</li>
<li>
<p><code>-t docker-demo:1.0</code> ：<code>-t</code>参数是指定镜像的名称（<code>repository</code>和<code>tag</code>）</p>
</li>
<li>
<p><code>.</code> : 最后的点是指构建时Dockerfile所在路径，由于我们进入了demo目录，所以指定的是<code>.</code>代表当前目录，也可以直接指定Dockerfile目录：</p>
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 直接指定Dockerfile目录</span>
</span></span><span class="line"><span class="cl">docker build -t docker-demo:1.0 /root/demo
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<p>结果：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135627756.png"
	width="1940"
	height="583"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135627756_hu5748096680416532390.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135627756_hu7303640106007911872.png 1024w"
	loading="lazy"
	
		alt="image-20241015135627756"
	
	
		class="gallery-image" 
		data-flex-grow="332"
		data-flex-basis="798px"
	
></p>
<p>查看镜像列表：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 查看镜像列表：</span>
</span></span><span class="line"><span class="cl">docker images
</span></span><span class="line"><span class="cl"><span class="c1"># 结果</span>
</span></span><span class="line"><span class="cl">REPOSITORY    TAG       IMAGE ID       CREATED          SIZE
</span></span><span class="line"><span class="cl">docker-demo   1.0       d6ab0b9e64b9   <span class="m">27</span> minutes ago   327MB
</span></span><span class="line"><span class="cl">nginx         latest    605c77e624dd   <span class="m">16</span> months ago    141MB
</span></span><span class="line"><span class="cl">mysql         latest    3218b38490ce   <span class="m">17</span> months ago    516MB
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后尝试运行该镜像：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 1.创建并运行容器</span>
</span></span><span class="line"><span class="cl">docker run -d --name dd -p 8080:8080 docker-demo:1.0
</span></span><span class="line"><span class="cl"><span class="c1"># 2.查看容器</span>
</span></span><span class="line"><span class="cl">dps
</span></span><span class="line"><span class="cl"><span class="c1"># 结果</span>
</span></span><span class="line"><span class="cl">CONTAINER ID   IMAGE             PORTS                                                  STATUS         NAMES
</span></span><span class="line"><span class="cl">78a000447b49   docker-demo:1.0   0.0.0.0:8080-&gt;8080/tcp, :::8090-&gt;8090/tcp              Up <span class="m">2</span> seconds   dd
</span></span><span class="line"><span class="cl">f63cfead8502   mysql             0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp   Up <span class="m">2</span> hours     mysql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3.访问</span>
</span></span><span class="line"><span class="cl">curl localhost:8080/hello/count
</span></span><span class="line"><span class="cl"><span class="c1"># 结果：</span>
</span></span><span class="line"><span class="cl">&lt;h5&gt;欢迎访问黑马商城, 这是您第1次访问&lt;h5&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="234curl命令">2.3.4curl命令
</h3><p><code>curl</code> 是一个功能强大的命令行工具，用于传输数据，支持多种协议，包括 HTTP、HTTPS、FTP、SCP、SFTP 等。它常用于测试和调试网络服务、上传和下载文件、与 RESTful APIs 交互等。</p>
<p>以下是一些常用的 <code>curl</code> 命令及其选项：</p>
<ol>
<li>
<p><strong>基本 GET 请求</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>指定用户代理</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -A <span class="s2">&#34;Mozilla/5.0&#34;</span> http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>发送 POST 请求</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -d <span class="s2">&#34;param1=value1&amp;param2=value2&#34;</span> http://example.com/resource
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>发送 JSON 数据</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -H <span class="s2">&#34;Content-Type: application/json&#34;</span> -d <span class="s1">&#39;{&#34;key1&#34;:&#34;value1&#34;, &#34;key2&#34;:&#34;value2&#34;}&#39;</span> http://example.com/resource
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>使用用户名和密码进行 HTTP 认证</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -u username:password http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>跟随重定向</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -L http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>设置请求超时</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl --connect-timeout <span class="m">10</span> http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>下载文件</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -O http://example.com/file.zip
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>上传文件</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -F <span class="s2">&#34;file=@localfile.txt&#34;</span> http://example.com/upload
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>使用 HTTPS</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -k https://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>查看请求头</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -I http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>保存响应头到文件</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -D headers.txt http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>使用代理</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -x http://proxyserver:port http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>设置 Cookie</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -b cookies.txt -c cookies.txt http://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>禁用 SSL 证书验证</strong>（不推荐在生产环境中使用）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -k https://example.com
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p><code>curl</code> 命令的灵活性和多功能性使其成为网络相关任务的必备工具。通过组合不同的选项，你可以执行复杂的网络请求和操作。在使用 <code>curl</code> 时，请确保了解每个选项的含义，以避免不必要的安全风险。</p>
<h2 id="24网络">2.4.网络
</h2><p>上节课我们创建了一个Java项目的容器，而Java项目往往需要访问其它各种中间件，例如MySQL、Redis等。现在，我们的容器之间能否互相访问呢？我们来测试一下</p>
<p>首先，我们查看下MySQL容器的详细信息，重点关注其中的网络IP地址：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 1.用基本命令，寻找Networks.bridge.IPAddress属性</span>
</span></span><span class="line"><span class="cl">docker inspect mysql
</span></span><span class="line"><span class="cl"><span class="c1"># 也可以使用format过滤结果</span>
</span></span><span class="line"><span class="cl">docker inspect --format<span class="o">=</span><span class="s1">&#39;{{range .NetworkSettings.Networks}}{{println .IPAddress}}{{end}}&#39;</span> mysql
</span></span><span class="line"><span class="cl"><span class="c1"># 得到IP地址如下：</span>
</span></span><span class="line"><span class="cl">172.17.0.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2.然后通过命令进入dd容器</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it dd bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3.在容器内，通过ping命令测试网络</span>
</span></span><span class="line"><span class="cl">ping 172.17.0.2
</span></span><span class="line"><span class="cl"><span class="c1"># 结果</span>
</span></span><span class="line"><span class="cl">PING 172.17.0.2 <span class="o">(</span>172.17.0.2<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 172.17.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.053 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 172.17.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.059 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 172.17.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.058 ms
</span></span></code></pre></td></tr></table>
</div>
</div><p>发现可以互联，没有问题。</p>
<p>但是，容器的网络IP其实是一个虚拟的IP，其值并不固定与某一个容器绑定，如果我们在开发时写死某个IP，而在部署时很可能MySQL容器的IP会发生变化，连接会失败。</p>
<p>所以，我们必须借助于docker的网络功能来解决这个问题，官方文档：</p>
<p><a class="link" href="https://docs.docker.com/engine/reference/commandline/network/"  target="_blank" rel="noopener"
    >https://docs.docker.com/engine/reference/commandline/network/</a></p>
<p>常见命令有：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>命令</strong></th>
          <th style="text-align: left"><strong>说明</strong></th>
          <th style="text-align: left"><strong>文档地址</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">docker network create</td>
          <td style="text-align: left">创建一个网络</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/network_create/"  target="_blank" rel="noopener"
    >docker network create</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker network ls</td>
          <td style="text-align: left">查看所有网络</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/network_ls/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker network rm</td>
          <td style="text-align: left">删除指定网络</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/network_rm/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker network prune</td>
          <td style="text-align: left">清除未使用的网络</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/network_prune/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker network connect</td>
          <td style="text-align: left">使指定容器连接加入某网络</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/network_connect/"  target="_blank" rel="noopener"
    >docs.docker.com</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker network disconnect</td>
          <td style="text-align: left">使指定容器连接离开某网络</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/network_disconnect/"  target="_blank" rel="noopener"
    >docker network disconnect</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docker network inspect</td>
          <td style="text-align: left">查看网络详细信息</td>
          <td style="text-align: left"><a class="link" href="https://docs.docker.com/engine/reference/commandline/network_inspect/"  target="_blank" rel="noopener"
    >docker network inspect</a></td>
      </tr>
  </tbody>
</table></div>
<p>教学演示：自定义网络</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 1.首先通过命令创建一个网络</span>
</span></span><span class="line"><span class="cl">docker network create hmall
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2.然后查看网络</span>
</span></span><span class="line"><span class="cl">docker network ls
</span></span><span class="line"><span class="cl"><span class="c1"># 结果：</span>
</span></span><span class="line"><span class="cl">NETWORK ID     NAME      DRIVER    SCOPE
</span></span><span class="line"><span class="cl">639bc44d0a87   bridge    bridge    <span class="nb">local</span>
</span></span><span class="line"><span class="cl">403f16ec62a2   hmall     bridge    <span class="nb">local</span>
</span></span><span class="line"><span class="cl">0dc0f72a0fbb   host      host      <span class="nb">local</span>
</span></span><span class="line"><span class="cl">cd8d3e8df47b   none      null      <span class="nb">local</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 其中，除了hmall以外，其它都是默认的网络</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3.让dd和mysql都加入该网络，注意，在加入网络时可以通过--alias给容器起别名</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 这样该网络内的其它容器可以用别名互相访问！</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3.1.mysql容器，指定别名为db，另外每一个容器都有一个别名是容器名</span>
</span></span><span class="line"><span class="cl">docker network connect hmall mysql --alias db
</span></span><span class="line"><span class="cl"><span class="c1"># 3.2.db容器，也就是我们的java项目</span>
</span></span><span class="line"><span class="cl">docker network connect hmall dd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4.进入dd容器，尝试利用别名访问db</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4.1.进入容器</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it dd bash
</span></span><span class="line"><span class="cl"><span class="c1"># 4.2.用db别名访问</span>
</span></span><span class="line"><span class="cl">ping db
</span></span><span class="line"><span class="cl"><span class="c1"># 结果</span>
</span></span><span class="line"><span class="cl">PING db <span class="o">(</span>172.18.0.2<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from mysql.hmall <span class="o">(</span>172.18.0.2<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.070 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from mysql.hmall <span class="o">(</span>172.18.0.2<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.056 ms
</span></span><span class="line"><span class="cl"><span class="c1"># 4.3.用容器名访问</span>
</span></span><span class="line"><span class="cl">ping mysql
</span></span><span class="line"><span class="cl"><span class="c1"># 结果：</span>
</span></span><span class="line"><span class="cl">PING mysql <span class="o">(</span>172.18.0.2<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from mysql.hmall <span class="o">(</span>172.18.0.2<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.044 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from mysql.hmall <span class="o">(</span>172.18.0.2<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.054 ms
</span></span></code></pre></td></tr></table>
</div>
</div><p>OK，现在无需记住IP地址也可以实现容器互联了。</p>
<p><strong>总结</strong>：</p>
<ul>
<li>在自定义网络中，可以给容器起多个别名，默认的别名是容器名本身</li>
<li>在同一个自定义网络中的容器，可以通过别名互相访问</li>
</ul>
<h1 id="3项目部署">3.项目部署
</h1><p>好了，我们已经熟悉了Docker的基本用法，接下来可以尝试部署项目了。</p>
<p>在课前资料中已经提供了一个黑马商城项目给大家，如图：</p>
<p>项目说明：</p>
<ul>
<li>hmall：商城的后端代码</li>
<li>hmall-portal：商城用户端的前端代码</li>
<li>hmall-admin：商城管理端的前端代码</li>
</ul>
<p>部署的容器及端口说明：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>项目</strong></th>
          <th style="text-align: left"><strong>容器名</strong></th>
          <th style="text-align: left"><strong>端口</strong></th>
          <th style="text-align: left"><strong>备注</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">hmall</td>
          <td style="text-align: left">hmall</td>
          <td style="text-align: left">8080</td>
          <td style="text-align: left">黑马商城后端API入口</td>
      </tr>
      <tr>
          <td style="text-align: left">hmall-portal</td>
          <td style="text-align: left">nginx</td>
          <td style="text-align: left">18080</td>
          <td style="text-align: left">黑马商城用户端入口</td>
      </tr>
      <tr>
          <td style="text-align: left">hmall-admin</td>
          <td style="text-align: left">18081</td>
          <td style="text-align: left">黑马商城管理端入口</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">mysql</td>
          <td style="text-align: left">mysql</td>
          <td style="text-align: left">3306</td>
          <td style="text-align: left">数据库</td>
      </tr>
  </tbody>
</table></div>
<p>在正式部署前，我们先删除之前的nginx、dd两个容器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">docker rm -f nginx dd
</span></span></code></pre></td></tr></table>
</div>
</div><p>mysql容器中已经准备好了商城的数据，所以就不再删除了。</p>
<h2 id="31部署java项目">3.1.部署Java项目
</h2><p><code>hmall</code>项目是一个maven聚合项目，使用IDEA打开<code>hmall</code>项目，查看项目结构如图：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135701266.png"
	width="676"
	height="293"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135701266_hu17555075161028792734.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135701266_hu14346934185123614030.png 1024w"
	loading="lazy"
	
		alt="image-20241015135701266"
	
	
		class="gallery-image" 
		data-flex-grow="230"
		data-flex-basis="553px"
	
></p>
<p>我们要部署的就是其中的<code>hm-service</code>，其中的配置文件采用了多环境的方式：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135712048.png"
	width="899"
	height="720"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135712048_hu17159555944374530816.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135712048_hu1968441526636039709.png 1024w"
	loading="lazy"
	
		alt="image-20241015135712048"
	
	
		class="gallery-image" 
		data-flex-grow="124"
		data-flex-basis="299px"
	
></p>
<p>其中的<code>application-dev.yaml</code>是部署到开发环境的配置，<code>application-local.yaml</code>是本地运行时的配置。</p>
<p>查看application.yaml，你会发现其中的JDBC地址并未写死，而是读取变量：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135730540.png"
	width="1735"
	height="602"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135730540_hu18062651145809402952.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135730540_hu1643520361016249059.png 1024w"
	loading="lazy"
	
		alt="image-20241015135730540"
	
	
		class="gallery-image" 
		data-flex-grow="288"
		data-flex-basis="691px"
	
></p>
<p>这两个变量在<code>application-dev.yaml</code>和<code>application-local.yaml</code>中并不相同：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135741223.png"
	width="1294"
	height="236"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135741223_hu11380568391711797238.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135741223_hu13935750197585358658.png 1024w"
	loading="lazy"
	
		alt="image-20241015135741223"
	
	
		class="gallery-image" 
		data-flex-grow="548"
		data-flex-basis="1315px"
	
></p>
<p>在dev开发环境（也就是Docker部署时）采用了mysql作为地址，刚好是我们的mysql容器名，只要两者在一个网络，就一定能互相访问。</p>
<p>我们将项目打包：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135756720.png"
	width="786"
	height="635"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135756720_hu3672270683452206019.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135756720_hu10566143013952586958.png 1024w"
	loading="lazy"
	
		alt="image-20241015135756720"
	
	
		class="gallery-image" 
		data-flex-grow="123"
		data-flex-basis="297px"
	
></p>
<p>结果：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135811013.png"
	width="778"
	height="609"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135811013_hu12136127985136575379.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135811013_hu14616767707582651947.png 1024w"
	loading="lazy"
	
		alt="image-20241015135811013"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="306px"
	
></p>
<p>将<code>hm-service</code>目录下的<code>Dockerfile</code>和<code>hm-service/target</code>目录下的<code>hm-service.jar</code>一起上传到虚拟机的<code>root</code>目录：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135827485.png"
	width="1249"
	height="407"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135827485_hu10643647508766640652.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135827485_hu6361062658509150058.png 1024w"
	loading="lazy"
	
		alt="image-20241015135827485"
	
	
		class="gallery-image" 
		data-flex-grow="306"
		data-flex-basis="736px"
	
></p>
<p>部署项目：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 1.构建项目镜像，不指定tag，则默认为latest</span>
</span></span><span class="line"><span class="cl">docker build -t hmall .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2.查看镜像</span>
</span></span><span class="line"><span class="cl">docker images
</span></span><span class="line"><span class="cl"><span class="c1"># 结果</span>
</span></span><span class="line"><span class="cl">REPOSITORY    TAG       IMAGE ID       CREATED          SIZE
</span></span><span class="line"><span class="cl">hmall         latest    0bb07b2c34b9   <span class="m">43</span> seconds ago   362MB
</span></span><span class="line"><span class="cl">docker-demo   1.0       49743484da68   <span class="m">24</span> hours ago     327MB
</span></span><span class="line"><span class="cl">nginx         latest    605c77e624dd   <span class="m">16</span> months ago    141MB
</span></span><span class="line"><span class="cl">mysql         latest    3218b38490ce   <span class="m">17</span> months ago    516MB
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3.创建并运行容器，并通过--network将其加入hmall网络，这样才能通过容器名访问mysql</span>
</span></span><span class="line"><span class="cl">docker run -d --name hmall --network hmall -p 8080:8080 hmall
</span></span></code></pre></td></tr></table>
</div>
</div><p>测试，通过浏览器访问：http://你的虚拟机地址:8080/search/list</p>
<h2 id="32部署前端">3.2.部署前端
</h2><p><code>hmall-portal</code>和<code>hmall-admin</code>是前端代码，需要基于nginx部署。在课前资料中已经给大家提供了nginx的部署目录：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135851873.png"
	width="1064"
	height="208"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135851873_hu1084241947366128220.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135851873_hu14967533354157669554.png 1024w"
	loading="lazy"
	
		alt="image-20241015135851873"
	
	
		class="gallery-image" 
		data-flex-grow="511"
		data-flex-basis="1227px"
	
></p>
<p>其中：</p>
<ul>
<li><code>html</code>是静态资源目录，我们需要把<code>hmall-portal</code>以及<code>hmall-admin</code>都复制进去</li>
<li><code>nginx.conf</code>是nginx的配置文件，主要是完成对<code>html</code>下的两个静态资源目录做代理</li>
</ul>
<p>我们现在要做的就是把整个nginx目录上传到虚拟机的<code>/root</code>目录下：</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135912525.png"
	width="1217"
	height="297"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135912525_hu16254610896386344066.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135912525_hu17449178795188828635.png 1024w"
	loading="lazy"
	
		alt="image-20241015135912525"
	
	
		class="gallery-image" 
		data-flex-grow="409"
		data-flex-basis="983px"
	
></p>
<p>然后创建nginx容器并完成两个挂载：</p>
<ul>
<li>把<code>/root/nginx/nginx.conf</code>挂载到<code>/etc/nginx/ng``inx.conf</code></li>
<li>把<code>/root/nginx/html</code>挂载到<code>/usr/share/nginx/html</code></li>
</ul>
<p>由于需要让nginx同时代理hmall-portal和hmall-admin两套前端资源，因此我们需要暴露两个端口：</p>
<ul>
<li>18080：对应hmall-portal</li>
<li>18081：对应hmall-admin</li>
</ul>
<p>命令如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">docker run -d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --name nginx <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p 18080:18080 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p 18081:18081 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /root/nginx/html:/usr/share/nginx/html <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --network hmall <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  nginx
</span></span></code></pre></td></tr></table>
</div>
</div><p>测试，通过浏览器访问：http://你的虚拟机ip:18080</p>
<p><img src="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135935005.png"
	width="2104"
	height="1004"
	srcset="/p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135935005_hu5576930467395389295.png 480w, /p/docker/%E5%BE%AE%E6%9C%8D%E5%8A%A1docker.assets/image-20241015135935005_hu1426455388682051915.png 1024w"
	loading="lazy"
	
		alt="image-20241015135935005"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="502px"
	
></p>
<h2 id="33dockercompose">3.3.DockerCompose
</h2><p>大家可以看到，我们部署一个简单的java项目，其中包含3个容器：</p>
<ul>
<li>MySQL</li>
<li>Nginx</li>
<li>Java项目</li>
</ul>
<p>而稍微复杂的项目，其中还会有各种各样的其它中间件，需要部署的东西远不止3个。如果还像之前那样手动的逐一部署，就太麻烦了。</p>
<p>而Docker Compose就可以帮助我们实现<strong>多个相互关联的Docker容器的快速部署</strong>。它允许用户通过一个单独的 docker-compose.yml 模板文件（YAML 格式）来定义一组相关联的应用容器。</p>
<h3 id="331基本语法">3.3.1.基本语法
</h3><p>docker-compose.yml文件的基本语法可以参考官方文档：</p>
<p><a class="link" href="https://docs.docker.com/compose/compose-file/compose-file-v3/"  target="_blank" rel="noopener"
    >https://docs.docker.com/compose/compose-file/compose-file-v3/</a></p>
<p>docker-compose文件中可以定义多个相互关联的应用容器，每一个应用容器被称为一个服务（service）。由于service就是在定义某个应用的运行时参数，因此与<code>docker run</code>参数非常相似。</p>
<p>举例来说，用docker run部署MySQL的命令如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">docker run -d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --name mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p 3306:3306 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -e <span class="nv">TZ</span><span class="o">=</span>Asia/Shanghai <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -e <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span><span class="m">123</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v ./mysql/data:/var/lib/mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v ./mysql/conf:/etc/mysql/conf.d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v ./mysql/init:/docker-entrypoint-initdb.d <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --network hmall
</span></span><span class="line"><span class="cl">  mysql
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果用<code>docker-compose.yml</code>文件来定义，就是这样：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-YAML" data-lang="YAML"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.8&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mysql</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3306:3306&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TZ</span><span class="p">:</span><span class="w"> </span><span class="l">Asia/Shanghai</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="m">123</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;./mysql/conf:/etc/mysql/conf.d&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;./mysql/data:/var/lib/mysql&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">new</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">new</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hmall</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>对比如下：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>docker run 参数</strong></th>
          <th style="text-align: left"><strong>docker compose 指令</strong></th>
          <th style="text-align: left"><strong>说明</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">&ndash;name</td>
          <td style="text-align: left">container_name</td>
          <td style="text-align: left">容器名称</td>
      </tr>
      <tr>
          <td style="text-align: left">-p</td>
          <td style="text-align: left">ports</td>
          <td style="text-align: left">端口映射</td>
      </tr>
      <tr>
          <td style="text-align: left">-e</td>
          <td style="text-align: left">environment</td>
          <td style="text-align: left">环境变量</td>
      </tr>
      <tr>
          <td style="text-align: left">-v</td>
          <td style="text-align: left">volumes</td>
          <td style="text-align: left">数据卷配置</td>
      </tr>
      <tr>
          <td style="text-align: left">&ndash;network</td>
          <td style="text-align: left">networks</td>
          <td style="text-align: left">网络</td>
      </tr>
  </tbody>
</table></div>
<p>明白了其中的对应关系，相信编写<code>docker-compose</code>文件应该难不倒大家。</p>
<p>黑马商城部署文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-YAML" data-lang="YAML"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.8&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mysql</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3306:3306&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TZ</span><span class="p">:</span><span class="w"> </span><span class="l">Asia/Shanghai</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="m">123</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;./mysql/conf:/etc/mysql/conf.d&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;./mysql/data:/var/lib/mysql&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;./mysql/init:/docker-entrypoint-initdb.d&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">hm-net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">hmall</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">Dockerfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">hmall</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;8080:8080&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">hm-net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nginx</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;18080:18080&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;18081:18081&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;./nginx/nginx.conf:/etc/nginx/nginx.conf&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;./nginx/html:/usr/share/nginx/html&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">hmall</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">hm-net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">hm-net</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hmall</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="332基础命令">3.3.2.基础命令
</h3><p>编写好docker-compose.yml文件，就可以部署项目了。常见的命令：</p>
<p><a class="link" href="https://docs.docker.com/compose/reference/"  target="_blank" rel="noopener"
    >https://docs.docker.com/compose/reference/</a></p>
<p>基本语法如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">docker compose <span class="o">[</span>OPTIONS<span class="o">]</span> <span class="o">[</span>COMMAND<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>其中，OPTIONS和COMMAND都是可选参数，比较常见的有：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>类型</strong></th>
          <th style="text-align: left"><strong>参数或指令</strong></th>
          <th style="text-align: left"><strong>说明</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Options</td>
          <td style="text-align: left">-f</td>
          <td style="text-align: left">指定compose文件的路径和名称</td>
      </tr>
      <tr>
          <td style="text-align: left">-p</td>
          <td style="text-align: left">指定project名称。project就是当前compose文件中设置的多个service的集合，是逻辑概念</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Commands</td>
          <td style="text-align: left">up</td>
          <td style="text-align: left">创建并启动所有service容器</td>
      </tr>
      <tr>
          <td style="text-align: left">down</td>
          <td style="text-align: left">停止并移除所有容器、网络</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">ps</td>
          <td style="text-align: left">列出所有启动的容器</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">logs</td>
          <td style="text-align: left">查看指定容器的日志</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">stop</td>
          <td style="text-align: left">停止容器</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">start</td>
          <td style="text-align: left">启动容器</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">restart</td>
          <td style="text-align: left">重启容器</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">top</td>
          <td style="text-align: left">查看运行的进程</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">exec</td>
          <td style="text-align: left">在指定的运行中容器中执行命令</td>
          <td style="text-align: left"></td>
      </tr>
  </tbody>
</table></div>
<p>教学演示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 1.进入root目录</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2.删除旧容器</span>
</span></span><span class="line"><span class="cl">docker rm -f <span class="k">$(</span>docker ps -qa<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3.删除hmall镜像</span>
</span></span><span class="line"><span class="cl">docker rmi hmall
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4.清空MySQL数据</span>
</span></span><span class="line"><span class="cl">rm -rf mysql/data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 5.启动所有, -d 参数是后台启动</span>
</span></span><span class="line"><span class="cl">docker compose up -d
</span></span><span class="line"><span class="cl"><span class="c1"># 结果：</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Building 15.5s <span class="o">(</span>8/8<span class="o">)</span> <span class="nv">FINISHED</span>
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load build definition from Dockerfile                                    0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; transferring dockerfile: 358B                                                    0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load .dockerignore                                                       0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; transferring context: 2B                                                         0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load metadata <span class="k">for</span> docker.io/library/openjdk:11.0-jre-buster             15.4s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>1/3<span class="o">]</span> FROM docker.io/library/openjdk:11.0-jre-buster@sha256:3546a17e6fb4ff4fa681c3  0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load build context                                                       0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; transferring context: 98B                                                        0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; CACHED <span class="o">[</span>2/3<span class="o">]</span> RUN ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime <span class="o">&amp;&amp;</span> <span class="nb">echo</span>   0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; CACHED <span class="o">[</span>3/3<span class="o">]</span> COPY hm-service.jar /app.jar                                           0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; exporting to image                                                                  0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; exporting layers                                                                 0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; writing image sha256:32eebee16acde22550232f2eb80c69d2ce813ed099640e4cfed2193f71  0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; naming to docker.io/library/root-hmall                                           0.0s
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Running 4/4
</span></span><span class="line"><span class="cl"> ✔ Network hmall    Created                                                             0.2s
</span></span><span class="line"><span class="cl"> ✔ Container mysql  Started                                                             0.5s
</span></span><span class="line"><span class="cl"> ✔ Container hmall  Started                                                             0.9s
</span></span><span class="line"><span class="cl"> ✔ Container nginx  Started                                                             1.5s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 6.查看镜像</span>
</span></span><span class="line"><span class="cl">docker compose images
</span></span><span class="line"><span class="cl"><span class="c1"># 结果</span>
</span></span><span class="line"><span class="cl">CONTAINER           REPOSITORY          TAG                 IMAGE ID            SIZE
</span></span><span class="line"><span class="cl">hmall               root-hmall          latest              32eebee16acd        362MB
</span></span><span class="line"><span class="cl">mysql               mysql               latest              3218b38490ce        516MB
</span></span><span class="line"><span class="cl">nginx               nginx               latest              605c77e624dd        141MB
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 7.查看容器</span>
</span></span><span class="line"><span class="cl">docker compose ps
</span></span><span class="line"><span class="cl"><span class="c1"># 结果</span>
</span></span><span class="line"><span class="cl">NAME                IMAGE               COMMAND                  SERVICE             CREATED             STATUS              PORTS
</span></span><span class="line"><span class="cl">hmall               root-hmall          <span class="s2">&#34;java -jar /app.jar&#34;</span>     hmall               <span class="m">54</span> seconds ago      Up <span class="m">52</span> seconds       0.0.0.0:8080-&gt;8080/tcp, :::8080-&gt;8080/tcp
</span></span><span class="line"><span class="cl">mysql               mysql               <span class="s2">&#34;docker-entrypoint.s…&#34;</span>   mysql               <span class="m">54</span> seconds ago      Up <span class="m">53</span> seconds       0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp
</span></span><span class="line"><span class="cl">nginx               nginx               <span class="s2">&#34;/docker-entrypoint.…&#34;</span>   nginx               <span class="m">54</span> seconds ago      Up <span class="m">52</span> seconds       80/tcp, 0.0.0.0:18080-18081-&gt;18080-18081/tcp, :::18080-18081-&gt;18080-18081/tcp
</span></span></code></pre></td></tr></table>
</div>
</div><p>打开浏览器，访问：http://yourIp:8080</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 yuwen
    </section>
    
    <section class="powerby">
        
            余 <br/>
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
